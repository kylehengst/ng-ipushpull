!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b():"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?exports.io=b():a.io=b()}(this,function(){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){"use strict";function d(a,b){"object"===("undefined"==typeof a?"undefined":f(a))&&(b=a,a=void 0),b=b||{};var c,d=g(a),h=d.source,l=d.id,m=d.path,n=k[l]&&m in k[l].nsps,o=b.forceNew||b["force new connection"]||!1===b.multiplex||n;return o?(j("ignoring socket cache for %s",h),c=i(h,b)):(k[l]||(j("new io instance for %s",h),k[l]=i(h,b)),c=k[l]),d.query&&!b.query?b.query=d.query:b&&"object"===f(b.query)&&(b.query=e(b.query)),c.socket(d.path,b)}function e(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")}var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=c(1),h=c(6),i=c(13),j=c(3)("socket.io-client");a.exports=b=d;var k=b.managers={};b.protocol=h.protocol,b.connect=d,b.Manager=c(13),b.Socket=c(40)},function(a,b,c){(function(b){"use strict";function d(a,c){var d=a;c=c||b.location,null==a&&(a=c.protocol+"//"+c.host),"string"==typeof a&&("/"===a.charAt(0)&&(a="/"===a.charAt(1)?c.protocol+a:c.host+a),/^(https?|wss?):\/\//.test(a)||(f("protocol-less url %s",a),a="undefined"!=typeof c?c.protocol+"//"+a:"https://"+a),f("parse %s",a),d=e(a)),d.port||(/^(http|ws)$/.test(d.protocol)?d.port="80":/^(http|ws)s$/.test(d.protocol)&&(d.port="443")),d.path=d.path||"/";var g=d.host.indexOf(":")!==-1,h=g?"["+d.host+"]":d.host;return d.id=d.protocol+"://"+h+":"+d.port,d.href=d.protocol+"://"+h+(c&&c.port===d.port?"":":"+d.port),d}var e=c(2),f=c(3)("socket.io-client:url");a.exports=d}).call(b,function(){return this}())},function(a,b){var c=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,d=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];a.exports=function(a){var b=a,e=a.indexOf("["),f=a.indexOf("]");e!=-1&&f!=-1&&(a=a.substring(0,e)+a.substring(e,f).replace(/:/g,";")+a.substring(f,a.length));for(var g=c.exec(a||""),h={},i=14;i--;)h[d[i]]=g[i]||"";return e!=-1&&f!=-1&&(h.source=b,h.host=h.host.substring(1,h.host.length-1).replace(/;/g,":"),h.authority=h.authority.replace("[","").replace("]","").replace(/;/g,":"),h.ipv6uri=!0),h}},function(a,b,c){function d(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function e(){var a=arguments,c=this.useColors;if(a[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+a[0]+(c?"%c ":" ")+"+"+b.humanize(this.diff),!c)return a;var d="color: "+this.color;a=[a[0],d,"color: inherit"].concat(Array.prototype.slice.call(a,1));var e=0,f=0;return a[0].replace(/%[a-z%]/g,function(a){"%%"!==a&&(e++,"%c"===a&&(f=e))}),a.splice(f,0,d),a}function f(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function g(a){try{null==a?b.storage.removeItem("debug"):b.storage.debug=a}catch(a){}}function h(){var a;try{a=b.storage.debug}catch(a){}return a}function i(){try{return window.localStorage}catch(a){}}b=a.exports=c(4),b.log=f,b.formatArgs=e,b.save=g,b.load=h,b.useColors=d,b.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:i(),b.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],b.formatters.j=function(a){return JSON.stringify(a)},b.enable(h())},function(a,b,c){function d(){return b.colors[k++%b.colors.length]}function e(a){function c(){}function e(){var a=e,c=+new Date,f=c-(j||c);a.diff=f,a.prev=j,a.curr=c,j=c,null==a.useColors&&(a.useColors=b.useColors()),null==a.color&&a.useColors&&(a.color=d());var g=Array.prototype.slice.call(arguments);g[0]=b.coerce(g[0]),"string"!=typeof g[0]&&(g=["%o"].concat(g));var h=0;g[0]=g[0].replace(/%([a-z%])/g,function(c,d){if("%%"===c)return c;h++;var e=b.formatters[d];if("function"==typeof e){var f=g[h];c=e.call(a,f),g.splice(h,1),h--}return c}),"function"==typeof b.formatArgs&&(g=b.formatArgs.apply(a,g));var i=e.log||b.log||void 0;i.apply(a,g)}c.enabled=!1,e.enabled=!0;var f=b.enabled(a)?e:c;return f.namespace=a,f}function f(a){b.save(a);for(var c=(a||"").split(/[\s,]+/),d=c.length,e=0;e<d;e++)c[e]&&(a=c[e].replace(/\*/g,".*?"),"-"===a[0]?b.skips.push(new RegExp("^"+a.substr(1)+"$")):b.names.push(new RegExp("^"+a+"$")))}function g(){b.enable("")}function h(a){var c,d;for(c=0,d=b.skips.length;c<d;c++)if(b.skips[c].test(a))return!1;for(c=0,d=b.names.length;c<d;c++)if(b.names[c].test(a))return!0;return!1}function i(a){return a instanceof Error?a.stack||a.message:a}b=a.exports=e,b.coerce=i,b.disable=g,b.enable=f,b.enabled=h,b.humanize=c(5),b.names=[],b.skips=[],b.formatters={};var j,k=0},function(a,b){function c(a){if(a=""+a,!(a.length>1e4)){var b=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a);if(b){var c=parseFloat(b[1]),d=(b[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return c*k;case"days":case"day":case"d":return c*j;case"hours":case"hour":case"hrs":case"hr":case"h":return c*i;case"minutes":case"minute":case"mins":case"min":case"m":return c*h;case"seconds":case"second":case"secs":case"sec":case"s":return c*g;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c}}}}function d(a){return a>=j?Math.round(a/j)+"d":a>=i?Math.round(a/i)+"h":a>=h?Math.round(a/h)+"m":a>=g?Math.round(a/g)+"s":a+"ms"}function e(a){return f(a,j,"day")||f(a,i,"hour")||f(a,h,"minute")||f(a,g,"second")||a+" ms"}function f(a,b,c){if(!(a<b))return a<1.5*b?Math.floor(a/b)+" "+c:Math.ceil(a/b)+" "+c+"s"}var g=1e3,h=60*g,i=60*h,j=24*i,k=365.25*j;a.exports=function(a,b){return b=b||{},"string"==typeof a?c(a):b.long?e(a):d(a)}},function(a,b,c){function d(){}function e(a){var c="",d=!1;return c+=a.type,b.BINARY_EVENT!=a.type&&b.BINARY_ACK!=a.type||(c+=a.attachments,c+="-"),a.nsp&&"/"!=a.nsp&&(d=!0,c+=a.nsp),null!=a.id&&(d&&(c+=",",d=!1),c+=a.id),null!=a.data&&(d&&(c+=","),c+=l.stringify(a.data)),k("encoded %j as %s",a,c),c}function f(a,b){function c(a){var c=n.deconstructPacket(a),d=e(c.packet),f=c.buffers;f.unshift(d),b(f)}n.removeBlobs(a,c)}function g(){this.reconstructor=null}function h(a){var c={},d=0;if(c.type=Number(a.charAt(0)),null==b.types[c.type])return j();if(b.BINARY_EVENT==c.type||b.BINARY_ACK==c.type){for(var e="";"-"!=a.charAt(++d)&&(e+=a.charAt(d),d!=a.length););if(e!=Number(e)||"-"!=a.charAt(d))throw new Error("Illegal attachments");c.attachments=Number(e)}if("/"==a.charAt(d+1))for(c.nsp="";++d;){var f=a.charAt(d);if(","==f)break;if(c.nsp+=f,d==a.length)break}else c.nsp="/";var g=a.charAt(d+1);if(""!==g&&Number(g)==g){for(c.id="";++d;){var f=a.charAt(d);if(null==f||Number(f)!=f){--d;break}if(c.id+=a.charAt(d),d==a.length)break}c.id=Number(c.id)}if(a.charAt(++d))try{c.data=l.parse(a.substr(d))}catch(a){return j()}return k("decoded %s as %j",a,c),c}function i(a){this.reconPack=a,this.buffers=[]}function j(a){return{type:b.ERROR,data:"parser error"}}var k=c(3)("socket.io-parser"),l=c(7),m=(c(9),c(10)),n=c(11),o=c(12);b.protocol=4,b.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],b.CONNECT=0,b.DISCONNECT=1,b.EVENT=2,b.ACK=3,b.ERROR=4,b.BINARY_EVENT=5,b.BINARY_ACK=6,b.Encoder=d,b.Decoder=g,d.prototype.encode=function(a,c){if(k("encoding packet %j",a),b.BINARY_EVENT==a.type||b.BINARY_ACK==a.type)f(a,c);else{var d=e(a);c([d])}},m(g.prototype),g.prototype.add=function(a){var c;if("string"==typeof a)c=h(a),b.BINARY_EVENT==c.type||b.BINARY_ACK==c.type?(this.reconstructor=new i(c),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",c)):this.emit("decoded",c);else{if(!o(a)&&!a.base64)throw new Error("Unknown type: "+a);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");c=this.reconstructor.takeBinaryData(a),c&&(this.reconstructor=null,this.emit("decoded",c))}},g.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},i.prototype.takeBinaryData=function(a){if(this.buffers.push(a),this.buffers.length==this.reconPack.attachments){var b=n.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),b}return null},i.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(a,b,c){(function(a,c){var d=!1;(function(){function e(a,b){function c(a){if(c[a]!==q)return c[a];var e;if("bug-string-char-index"==a)e="a"!="a"[0];else if("json"==a)e=c("json-stringify")&&c("json-parse");else{var g,h='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==a){var i=b.stringify,k="function"==typeof i&&t;if(k){(g=function(){return 1}).toJSON=g;try{k="0"===i(0)&&"0"===i(new d)&&'""'==i(new f)&&i(s)===q&&i(q)===q&&i()===q&&"1"===i(g)&&"[1]"==i([g])&&"[null]"==i([q])&&"null"==i(null)&&"[null,null,null]"==i([q,s,null])&&i({a:[g,!0,!1,null,"\0\b\n\f\r\t"]})==h&&"1"===i(null,g)&&"[\n 1,\n 2\n]"==i([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==i(new j(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==i(new j(864e13))&&'"-000001-01-01T00:00:00.000Z"'==i(new j(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==i(new j(-1))}catch(a){k=!1}}e=k}if("json-parse"==a){var l=b.parse;if("function"==typeof l)try{if(0===l("0")&&!l(!1)){g=l(h);var m=5==g.a.length&&1===g.a[0];if(m){try{m=!l('"\t"')}catch(a){}if(m)try{m=1!==l("01")}catch(a){}if(m)try{m=1!==l("1.")}catch(a){}}}}catch(a){m=!1}e=m}}return c[a]=!!e}a||(a=i.Object()),b||(b=i.Object());var d=a.Number||i.Number,f=a.String||i.String,h=a.Object||i.Object,j=a.Date||i.Date,k=a.SyntaxError||i.SyntaxError,l=a.TypeError||i.TypeError,m=a.Math||i.Math,n=a.JSON||i.JSON;"object"==typeof n&&n&&(b.stringify=n.stringify,b.parse=n.parse);var o,p,q,r=h.prototype,s=r.toString,t=new j(-0xc782b5b800cec);try{t=t.getUTCFullYear()==-109252&&0===t.getUTCMonth()&&1===t.getUTCDate()&&10==t.getUTCHours()&&37==t.getUTCMinutes()&&6==t.getUTCSeconds()&&708==t.getUTCMilliseconds()}catch(a){}if(!c("json")){var u="[object Function]",v="[object Date]",w="[object Number]",x="[object String]",y="[object Array]",z="[object Boolean]",A=c("bug-string-char-index");if(!t)var B=m.floor,C=[0,31,59,90,120,151,181,212,243,273,304,334],D=function(a,b){return C[b]+365*(a-1970)+B((a-1969+(b=+(b>1)))/4)-B((a-1901+b)/100)+B((a-1601+b)/400)};if((o=r.hasOwnProperty)||(o=function(a){var b,c={};return(c.__proto__=null,c.__proto__={toString:1},c).toString!=s?o=function(a){var b=this.__proto__,c=a in(this.__proto__=null,this);return this.__proto__=b,c}:(b=c.constructor,o=function(a){var c=(this.constructor||b).prototype;return a in this&&!(a in c&&this[a]===c[a])}),c=null,o.call(this,a)}),p=function(a,b){var c,d,e,f=0;(c=function(){this.valueOf=0}).prototype.valueOf=0,d=new c;for(e in d)o.call(d,e)&&f++;return c=d=null,f?p=2==f?function(a,b){var c,d={},e=s.call(a)==u;for(c in a)e&&"prototype"==c||o.call(d,c)||!(d[c]=1)||!o.call(a,c)||b(c)}:function(a,b){var c,d,e=s.call(a)==u;for(c in a)e&&"prototype"==c||!o.call(a,c)||(d="constructor"===c)||b(c);(d||o.call(a,c="constructor"))&&b(c)}:(d=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],p=function(a,b){var c,e,f=s.call(a)==u,h=!f&&"function"!=typeof a.constructor&&g[typeof a.hasOwnProperty]&&a.hasOwnProperty||o;for(c in a)f&&"prototype"==c||!h.call(a,c)||b(c);for(e=d.length;c=d[--e];h.call(a,c)&&b(c));}),p(a,b)},!c("json-stringify")){var E={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},F="000000",G=function(a,b){return(F+(b||0)).slice(-a)},H="\\u00",I=function(a){for(var b='"',c=0,d=a.length,e=!A||d>10,f=e&&(A?a.split(""):a);c<d;c++){var g=a.charCodeAt(c);switch(g){case 8:case 9:case 10:case 12:case 13:case 34:case 92:b+=E[g];break;default:if(g<32){b+=H+G(2,g.toString(16));break}b+=e?f[c]:a.charAt(c)}}return b+'"'},J=function(a,b,c,d,e,f,g){var h,i,j,k,m,n,r,t,u,A,C,E,F,H,K,L;try{h=b[a]}catch(a){}if("object"==typeof h&&h)if(i=s.call(h),i!=v||o.call(h,"toJSON"))"function"==typeof h.toJSON&&(i!=w&&i!=x&&i!=y||o.call(h,"toJSON"))&&(h=h.toJSON(a));else if(h>-1/0&&h<1/0){if(D){for(m=B(h/864e5),j=B(m/365.2425)+1970-1;D(j+1,0)<=m;j++);for(k=B((m-D(j,0))/30.42);D(j,k+1)<=m;k++);m=1+m-D(j,k),n=(h%864e5+864e5)%864e5,r=B(n/36e5)%24,t=B(n/6e4)%60,u=B(n/1e3)%60,A=n%1e3}else j=h.getUTCFullYear(),k=h.getUTCMonth(),m=h.getUTCDate(),r=h.getUTCHours(),t=h.getUTCMinutes(),u=h.getUTCSeconds(),A=h.getUTCMilliseconds();h=(j<=0||j>=1e4?(j<0?"-":"+")+G(6,j<0?-j:j):G(4,j))+"-"+G(2,k+1)+"-"+G(2,m)+"T"+G(2,r)+":"+G(2,t)+":"+G(2,u)+"."+G(3,A)+"Z"}else h=null;if(c&&(h=c.call(b,a,h)),null===h)return"null";if(i=s.call(h),i==z)return""+h;if(i==w)return h>-1/0&&h<1/0?""+h:"null";if(i==x)return I(""+h);if("object"==typeof h){for(H=g.length;H--;)if(g[H]===h)throw l();if(g.push(h),C=[],K=f,f+=e,i==y){for(F=0,H=h.length;F<H;F++)E=J(F,h,c,d,e,f,g),C.push(E===q?"null":E);L=C.length?e?"[\n"+f+C.join(",\n"+f)+"\n"+K+"]":"["+C.join(",")+"]":"[]"}else p(d||h,function(a){var b=J(a,h,c,d,e,f,g);b!==q&&C.push(I(a)+":"+(e?" ":"")+b)}),L=C.length?e?"{\n"+f+C.join(",\n"+f)+"\n"+K+"}":"{"+C.join(",")+"}":"{}";return g.pop(),L}};b.stringify=function(a,b,c){var d,e,f,h;if(g[typeof b]&&b)if((h=s.call(b))==u)e=b;else if(h==y){f={};for(var i,j=0,k=b.length;j<k;i=b[j++],h=s.call(i),(h==x||h==w)&&(f[i]=1));}if(c)if((h=s.call(c))==w){if((c-=c%1)>0)for(d="",c>10&&(c=10);d.length<c;d+=" ");}else h==x&&(d=c.length<=10?c:c.slice(0,10));return J("",(i={},i[""]=a,i),e,f,d,"",[])}}if(!c("json-parse")){var K,L,M=f.fromCharCode,N={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},O=function(){throw K=L=null,k()},P=function(){for(var a,b,c,d,e,f=L,g=f.length;K<g;)switch(e=f.charCodeAt(K)){case 9:case 10:case 13:case 32:K++;break;case 123:case 125:case 91:case 93:case 58:case 44:return a=A?f.charAt(K):f[K],K++,a;case 34:for(a="@",K++;K<g;)if(e=f.charCodeAt(K),e<32)O();else if(92==e)switch(e=f.charCodeAt(++K)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:a+=N[e],K++;break;case 117:for(b=++K,c=K+4;K<c;K++)e=f.charCodeAt(K),e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70||O();a+=M("0x"+f.slice(b,K));break;default:O()}else{if(34==e)break;for(e=f.charCodeAt(K),b=K;e>=32&&92!=e&&34!=e;)e=f.charCodeAt(++K);a+=f.slice(b,K)}if(34==f.charCodeAt(K))return K++,a;O();default:if(b=K,45==e&&(d=!0,e=f.charCodeAt(++K)),e>=48&&e<=57){for(48==e&&(e=f.charCodeAt(K+1),e>=48&&e<=57)&&O(),d=!1;K<g&&(e=f.charCodeAt(K),e>=48&&e<=57);K++);if(46==f.charCodeAt(K)){for(c=++K;c<g&&(e=f.charCodeAt(c),e>=48&&e<=57);c++);c==K&&O(),K=c}if(e=f.charCodeAt(K),101==e||69==e){for(e=f.charCodeAt(++K),43!=e&&45!=e||K++,c=K;c<g&&(e=f.charCodeAt(c),e>=48&&e<=57);c++);c==K&&O(),K=c}return+f.slice(b,K)}if(d&&O(),"true"==f.slice(K,K+4))return K+=4,!0;if("false"==f.slice(K,K+5))return K+=5,!1;if("null"==f.slice(K,K+4))return K+=4,null;O()}return"$"},Q=function(a){var b,c;if("$"==a&&O(),"string"==typeof a){if("@"==(A?a.charAt(0):a[0]))return a.slice(1);if("["==a){for(b=[];a=P(),"]"!=a;c||(c=!0))c&&(","==a?(a=P(),"]"==a&&O()):O()),","==a&&O(),b.push(Q(a));return b}if("{"==a){for(b={};a=P(),"}"!=a;c||(c=!0))c&&(","==a?(a=P(),"}"==a&&O()):O()),","!=a&&"string"==typeof a&&"@"==(A?a.charAt(0):a[0])&&":"==P()||O(),b[a.slice(1)]=Q(P());return b}O()}return a},R=function(a,b,c){var d=S(a,b,c);d===q?delete a[b]:a[b]=d},S=function(a,b,c){var d,e=a[b];if("object"==typeof e&&e)if(s.call(e)==y)for(d=e.length;d--;)R(e,d,c);else p(e,function(a){R(e,a,c)});return c.call(a,b,e)};b.parse=function(a,b){var c,d;return K=0,L=""+a,c=Q(P()),"$"!=P()&&O(),K=L=null,b&&s.call(b)==u?S((d={},d[""]=c,d),"",b):c}}}return b.runInContext=e,b}var f="function"==typeof d&&d.amd,g={function:!0,object:!0},h=g[typeof b]&&b&&!b.nodeType&&b,i=g[typeof window]&&window||this,j=h&&g[typeof a]&&a&&!a.nodeType&&"object"==typeof c&&c;if(!j||j.global!==j&&j.window!==j&&j.self!==j||(i=j),h&&!f)e(i,h);else{var k=i.JSON,l=i.JSON3,m=!1,n=e(i,i.JSON3={noConflict:function(){return m||(m=!0,i.JSON=k,i.JSON3=l,k=l=null),n}});i.JSON={parse:n.parse,stringify:n.stringify}}f&&d(function(){return n})}).call(this)}).call(b,c(8)(a),function(){return this}())},function(a,b){a.exports=function(a){return a.webpackPolyfill||(a.deprecate=function(){},a.paths=[],a.children=[],a.webpackPolyfill=1),a}},function(a,b){a.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},function(a,b){function c(a){if(a)return d(a)}function d(a){for(var b in c.prototype)a[b]=c.prototype[b];return a}a.exports=c,c.prototype.on=c.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks[a]=this._callbacks[a]||[]).push(b),this},c.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(this,arguments)}var d=this;return this._callbacks=this._callbacks||{},c.fn=b,this.on(a,c),this},c.prototype.off=c.prototype.removeListener=c.prototype.removeAllListeners=c.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var d,e=0;e<c.length;e++)if(d=c[e],d===b||d.fn===b){c.splice(e,1);break}return this},c.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d)c[d].apply(this,b)}return this},c.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks[a]||[]},c.prototype.hasListeners=function(a){return!!this.listeners(a).length}},function(a,b,c){(function(a){var d=c(9),e=c(12);b.deconstructPacket=function(a){function b(a){if(!a)return a;if(e(a)){var f={_placeholder:!0,num:c.length};return c.push(a),f}if(d(a)){for(var g=new Array(a.length),h=0;h<a.length;h++)g[h]=b(a[h]);return g}if("object"==typeof a&&!(a instanceof Date)){var g={};for(var i in a)g[i]=b(a[i]);return g}return a}var c=[],f=a.data,g=a;return g.data=b(f),g.attachments=c.length,{packet:g,buffers:c}},b.reconstructPacket=function(a,b){function c(a){if(a&&a._placeholder){var e=b[a.num];return e}if(d(a)){for(var f=0;f<a.length;f++)a[f]=c(a[f]);return a}if(a&&"object"==typeof a){for(var g in a)a[g]=c(a[g]);return a}return a}return a.data=c(a.data),a.attachments=void 0,a},b.removeBlobs=function(b,c){function f(b,i,j){if(!b)return b;if(a.Blob&&b instanceof Blob||a.File&&b instanceof File){g++;var k=new FileReader;k.onload=function(){j?j[i]=this.result:h=this.result,--g||c(h)},k.readAsArrayBuffer(b)}else if(d(b))for(var l=0;l<b.length;l++)f(b[l],l,b);else if(b&&"object"==typeof b&&!e(b))for(var m in b)f(b[m],m,b)}var g=0,h=b;f(h),g||c(h)}}).call(b,function(){return this}())},function(a,b){(function(b){function c(a){return b.Buffer&&b.Buffer.isBuffer(a)||b.ArrayBuffer&&a instanceof ArrayBuffer}a.exports=c}).call(b,function(){return this}())},function(a,b,c){"use strict";function d(a,b){return this instanceof d?(a&&"object"===("undefined"==typeof a?"undefined":e(a))&&(b=a,a=void 0),b=b||{},b.path=b.path||"/socket.io",this.nsps={},this.subs=[],this.opts=b,this.reconnection(b.reconnection!==!1),this.reconnectionAttempts(b.reconnectionAttempts||1/0),this.reconnectionDelay(b.reconnectionDelay||1e3),this.reconnectionDelayMax(b.reconnectionDelayMax||5e3),this.randomizationFactor(b.randomizationFactor||.5),this.backoff=new n({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==b.timeout?2e4:b.timeout),this.readyState="closed",this.uri=a,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new i.Encoder,this.decoder=new i.Decoder,this.autoConnect=b.autoConnect!==!1,void(this.autoConnect&&this.open())):new d(a,b)}var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f=c(14),g=c(40),h=c(41),i=c(6),j=c(43),k=c(44),l=c(3)("socket.io-client:manager"),m=c(38),n=c(46),o=Object.prototype.hasOwnProperty;a.exports=d,d.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var a in this.nsps)o.call(this.nsps,a)&&this.nsps[a].emit.apply(this.nsps[a],arguments)},d.prototype.updateSocketIds=function(){for(var a in this.nsps)o.call(this.nsps,a)&&(this.nsps[a].id=this.engine.id)},h(d.prototype),d.prototype.reconnection=function(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection},d.prototype.reconnectionAttempts=function(a){return arguments.length?(this._reconnectionAttempts=a,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(a){return arguments.length?(this._reconnectionDelay=a,this.backoff&&this.backoff.setMin(a),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(a){return arguments.length?(this._randomizationFactor=a,this.backoff&&this.backoff.setJitter(a),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=function(a){return arguments.length?(this._reconnectionDelayMax=a,this.backoff&&this.backoff.setMax(a),this):this._reconnectionDelayMax},d.prototype.timeout=function(a){return arguments.length?(this._timeout=a,this):this._timeout},d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},d.prototype.open=d.prototype.connect=function(a,b){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=f(this.uri,this.opts);var c=this.engine,d=this;this.readyState="opening",this.skipReconnect=!1;var e=j(c,"open",function(){d.onopen(),a&&a()}),g=j(c,"error",function(b){if(l("connect_error"),d.cleanup(),d.readyState="closed",d.emitAll("connect_error",b),a){var c=new Error("Connection error");c.data=b,a(c)}else d.maybeReconnectOnOpen()});if(!1!==this._timeout){var h=this._timeout;l("connect attempt will timeout after %d",h);var i=setTimeout(function(){l("connect attempt timed out after %d",h),e.destroy(),c.close(),c.emit("error","timeout"),d.emitAll("connect_timeout",h)},h);this.subs.push({destroy:function(){clearTimeout(i)}})}return this.subs.push(e),this.subs.push(g),this},d.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var a=this.engine;this.subs.push(j(a,"data",k(this,"ondata"))),this.subs.push(j(a,"ping",k(this,"onping"))),this.subs.push(j(a,"pong",k(this,"onpong"))),this.subs.push(j(a,"error",k(this,"onerror"))),this.subs.push(j(a,"close",k(this,"onclose"))),this.subs.push(j(this.decoder,"decoded",k(this,"ondecoded")))},d.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},d.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},d.prototype.ondata=function(a){this.decoder.add(a)},d.prototype.ondecoded=function(a){this.emit("packet",a)},d.prototype.onerror=function(a){l("error",a),this.emitAll("error",a)},d.prototype.socket=function(a,b){function c(){~m(e.connecting,d)||e.connecting.push(d)}var d=this.nsps[a];if(!d){d=new g(this,a,b),this.nsps[a]=d;var e=this;d.on("connecting",c),d.on("connect",function(){d.id=e.engine.id}),this.autoConnect&&c()}return d},d.prototype.destroy=function(a){var b=m(this.connecting,a);~b&&this.connecting.splice(b,1),this.connecting.length||this.close()},d.prototype.packet=function(a){l("writing packet %j",a);var b=this;a.query&&0===a.type&&(a.nsp+="?"+a.query),b.encoding?b.packetBuffer.push(a):(b.encoding=!0,this.encoder.encode(a,function(c){for(var d=0;d<c.length;d++)b.engine.write(c[d],a.options);b.encoding=!1,b.processPacketQueue()}))},d.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}},d.prototype.cleanup=function(){l("cleanup");for(var a=this.subs.length,b=0;b<a;b++){var c=this.subs.shift();c.destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},d.prototype.close=d.prototype.disconnect=function(){l("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},d.prototype.onclose=function(a){l("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",a),this._reconnection&&!this.skipReconnect&&this.reconnect()},d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var b=this.backoff.duration();l("will wait %dms before reconnect attempt",b),this.reconnecting=!0;var c=setTimeout(function(){a.skipReconnect||(l("attempting reconnect"),a.emitAll("reconnect_attempt",a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(b){b?(l("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",b.data)):(l("reconnect success"),a.onreconnect())}))},b);this.subs.push({destroy:function(){clearTimeout(c)}})}},d.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",a)}},function(a,b,c){a.exports=c(15)},function(a,b,c){a.exports=c(16),a.exports.parser=c(23)},function(a,b,c){(function(b){function d(a,c){if(!(this instanceof d))return new d(a,c);c=c||{},a&&"object"==typeof a&&(c=a,a=null),a?(a=k(a),c.hostname=a.host,c.secure="https"===a.protocol||"wss"===a.protocol,c.port=a.port,a.query&&(c.query=a.query)):c.host&&(c.hostname=k(c.host).host),this.secure=null!=c.secure?c.secure:b.location&&"https:"===location.protocol,c.hostname&&!c.port&&(c.port=this.secure?"443":"80"),this.agent=c.agent||!1,this.hostname=c.hostname||(b.location?location.hostname:"localhost"),this.port=c.port||(b.location&&location.port?location.port:this.secure?443:80),this.query=c.query||{},"string"==typeof this.query&&(this.query=m.decode(this.query)),this.upgrade=!1!==c.upgrade,this.path=(c.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!c.forceJSONP,this.jsonp=!1!==c.jsonp,this.forceBase64=!!c.forceBase64,this.enablesXDR=!!c.enablesXDR,this.timestampParam=c.timestampParam||"t",this.timestampRequests=c.timestampRequests,this.transports=c.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=c.policyPort||843,this.rememberUpgrade=c.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=c.onlyBinaryUpgrades,this.perMessageDeflate=!1!==c.perMessageDeflate&&(c.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=c.pfx||null,this.key=c.key||null,this.passphrase=c.passphrase||null,this.cert=c.cert||null,this.ca=c.ca||null,this.ciphers=c.ciphers||null,this.rejectUnauthorized=void 0===c.rejectUnauthorized?null:c.rejectUnauthorized;var e="object"==typeof b&&b;e.global===e&&c.extraHeaders&&Object.keys(c.extraHeaders).length>0&&(this.extraHeaders=c.extraHeaders),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}function e(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}var f=c(17),g=c(31),h=c(3)("engine.io-client:socket"),i=c(38),j=c(23),k=c(2),l=c(39),m=c(32);a.exports=d,d.priorWebsocketSuccess=!1,g(d.prototype),d.protocol=j.protocol,d.Socket=d,d.Transport=c(22),d.transports=c(17),d.parser=c(23),d.prototype.createTransport=function(a){h('creating transport "%s"',a);var b=e(this.query);b.EIO=j.protocol,b.transport=a,this.id&&(b.sid=this.id);var c=new f[a]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:b,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders});return c},d.prototype.open=function(){var a;if(this.rememberUpgrade&&d.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)a="websocket";else{if(0===this.transports.length){var b=this;return void setTimeout(function(){b.emit("error","No transports available")},0)}a=this.transports[0]}this.readyState="opening";try{a=this.createTransport(a)}catch(a){return this.transports.shift(),void this.open()}a.open(),this.setTransport(a)},d.prototype.setTransport=function(a){h("setting transport %s",a.name);var b=this;this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=a,a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})},d.prototype.probe=function(a){function b(){if(m.onlyBinaryUpgrades){var b=!this.supportsBinary&&m.transport.supportsBinary;l=l||b}l||(h('probe transport "%s" opened',a),k.send([{type:"ping",data:"probe"}]),k.once("packet",function(b){if(!l)if("pong"===b.type&&"probe"===b.data){if(h('probe transport "%s" pong',a),m.upgrading=!0,m.emit("upgrading",k),!k)return;d.priorWebsocketSuccess="websocket"===k.name,h('pausing current transport "%s"',m.transport.name),m.transport.pause(function(){l||"closed"!==m.readyState&&(h("changing transport and sending upgrade packet"),j(),m.setTransport(k),k.send([{type:"upgrade"}]),m.emit("upgrade",k),k=null,m.upgrading=!1,m.flush())})}else{h('probe transport "%s" failed',a);var c=new Error("probe error");c.transport=k.name,m.emit("upgradeError",c)}}))}function c(){l||(l=!0,j(),k.close(),k=null)}function e(b){var d=new Error("probe error: "+b);d.transport=k.name,c(),h('probe transport "%s" failed because of error: %s',a,b),m.emit("upgradeError",d)}function f(){e("transport closed")}function g(){e("socket closed")}function i(a){k&&a.name!==k.name&&(h('"%s" works - aborting "%s"',a.name,k.name),c())}function j(){k.removeListener("open",b),k.removeListener("error",e),k.removeListener("close",f),m.removeListener("close",g),m.removeListener("upgrading",i)}h('probing transport "%s"',a);var k=this.createTransport(a,{probe:1}),l=!1,m=this;d.priorWebsocketSuccess=!1,k.once("open",b),k.once("error",e),k.once("close",f),this.once("close",g),this.once("upgrading",i),k.open()},d.prototype.onOpen=function(){if(h("socket open"),this.readyState="open",d.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){h("starting upgrade probes");for(var a=0,b=this.upgrades.length;a<b;a++)this.probe(this.upgrades[a])}},d.prototype.onPacket=function(a){if("opening"===this.readyState||"open"===this.readyState)switch(h('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),a.type){case"open":this.onHandshake(l(a.data));break;case"pong":this.setPing(),
this.emit("pong");break;case"error":var b=new Error("server error");b.code=a.data,this.onError(b);break;case"message":this.emit("data",a.data),this.emit("message",a.data)}else h('packet received with socket readyState "%s"',this.readyState)},d.prototype.onHandshake=function(a){this.emit("handshake",a),this.id=a.sid,this.transport.query.sid=a.sid,this.upgrades=this.filterUpgrades(a.upgrades),this.pingInterval=a.pingInterval,this.pingTimeout=a.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},d.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);var b=this;b.pingTimeoutTimer=setTimeout(function(){"closed"!==b.readyState&&b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)},d.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer),a.pingIntervalTimer=setTimeout(function(){h("writing ping packet - expecting pong within %sms",a.pingTimeout),a.ping(),a.onHeartbeat(a.pingTimeout)},a.pingInterval)},d.prototype.ping=function(){var a=this;this.sendPacket("ping",function(){a.emit("ping")})},d.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},d.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(h("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},d.prototype.write=d.prototype.send=function(a,b,c){return this.sendPacket("message",a,b,c),this},d.prototype.sendPacket=function(a,b,c,d){if("function"==typeof b&&(d=b,b=void 0),"function"==typeof c&&(d=c,c=null),"closing"!==this.readyState&&"closed"!==this.readyState){c=c||{},c.compress=!1!==c.compress;var e={type:a,data:b,options:c};this.emit("packetCreate",e),this.writeBuffer.push(e),d&&this.once("flush",d),this.flush()}},d.prototype.close=function(){function a(){d.onClose("forced close"),h("socket closing - telling transport to close"),d.transport.close()}function b(){d.removeListener("upgrade",b),d.removeListener("upgradeError",b),a()}function c(){d.once("upgrade",b),d.once("upgradeError",b)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var d=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?c():a()}):this.upgrading?c():a()}return this},d.prototype.onError=function(a){h("socket error %j",a),d.priorWebsocketSuccess=!1,this.emit("error",a),this.onClose("transport error",a)},d.prototype.onClose=function(a,b){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){h('socket close with reason: "%s"',a);var c=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",a,b),c.writeBuffer=[],c.prevBufferLen=0}},d.prototype.filterUpgrades=function(a){for(var b=[],c=0,d=a.length;c<d;c++)~i(this.transports,a[c])&&b.push(a[c]);return b}}).call(b,function(){return this}())},function(a,b,c){(function(a){function d(b){var c,d=!1,h=!1,i=!1!==b.jsonp;if(a.location){var j="https:"===location.protocol,k=location.port;k||(k=j?443:80),d=b.hostname!==location.hostname||k!==b.port,h=b.secure!==j}if(b.xdomain=d,b.xscheme=h,c=new e(b),"open"in c&&!b.forceJSONP)return new f(b);if(!i)throw new Error("JSONP disabled");return new g(b)}var e=c(18),f=c(20),g=c(35),h=c(36);b.polling=d,b.websocket=h}).call(b,function(){return this}())},function(a,b,c){var d=c(19);a.exports=function(a){var b=a.xdomain,c=a.xscheme,e=a.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!b||d))return new XMLHttpRequest}catch(a){}try{if("undefined"!=typeof XDomainRequest&&!c&&e)return new XDomainRequest}catch(a){}if(!b)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}},function(a,b){try{a.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(b){a.exports=!1}},function(a,b,c){(function(b){function d(){}function e(a){if(i.call(this,a),b.location){var c="https:"===location.protocol,d=location.port;d||(d=c?443:80),this.xd=a.hostname!==b.location.hostname||d!==a.port,this.xs=a.secure!==c}else this.extraHeaders=a.extraHeaders}function f(a){this.method=a.method||"GET",this.uri=a.uri,this.xd=!!a.xd,this.xs=!!a.xs,this.async=!1!==a.async,this.data=void 0!==a.data?a.data:null,this.agent=a.agent,this.isBinary=a.isBinary,this.supportsBinary=a.supportsBinary,this.enablesXDR=a.enablesXDR,this.pfx=a.pfx,this.key=a.key,this.passphrase=a.passphrase,this.cert=a.cert,this.ca=a.ca,this.ciphers=a.ciphers,this.rejectUnauthorized=a.rejectUnauthorized,this.extraHeaders=a.extraHeaders,this.create()}function g(){for(var a in f.requests)f.requests.hasOwnProperty(a)&&f.requests[a].abort()}var h=c(18),i=c(21),j=c(31),k=c(33),l=c(3)("engine.io-client:polling-xhr");a.exports=e,a.exports.Request=f,k(e,i),e.prototype.supportsBinary=!0,e.prototype.request=function(a){return a=a||{},a.uri=this.uri(),a.xd=this.xd,a.xs=this.xs,a.agent=this.agent||!1,a.supportsBinary=this.supportsBinary,a.enablesXDR=this.enablesXDR,a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized,a.extraHeaders=this.extraHeaders,new f(a)},e.prototype.doWrite=function(a,b){var c="string"!=typeof a&&void 0!==a,d=this.request({method:"POST",data:a,isBinary:c}),e=this;d.on("success",b),d.on("error",function(a){e.onError("xhr post error",a)}),this.sendXhr=d},e.prototype.doPoll=function(){l("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)}),a.on("error",function(a){b.onError("xhr poll error",a)}),this.pollXhr=a},j(f.prototype),f.prototype.create=function(){var a={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized;var c=this.xhr=new h(a),d=this;try{l("xhr open %s: %s",this.method,this.uri),c.open(this.method,this.uri,this.async);try{if(this.extraHeaders){c.setDisableHeaderCheck(!0);for(var e in this.extraHeaders)this.extraHeaders.hasOwnProperty(e)&&c.setRequestHeader(e,this.extraHeaders[e])}}catch(a){}if(this.supportsBinary&&(c.responseType="arraybuffer"),"POST"===this.method)try{this.isBinary?c.setRequestHeader("Content-type","application/octet-stream"):c.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(a){}"withCredentials"in c&&(c.withCredentials=!0),this.hasXDR()?(c.onload=function(){d.onLoad()},c.onerror=function(){d.onError(c.responseText)}):c.onreadystatechange=function(){4===c.readyState&&(200===c.status||1223===c.status?d.onLoad():setTimeout(function(){d.onError(c.status)},0))},l("xhr data %s",this.data),c.send(this.data)}catch(a){return void setTimeout(function(){d.onError(a)},0)}b.document&&(this.index=f.requestsCount++,f.requests[this.index]=this)},f.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},f.prototype.onData=function(a){this.emit("data",a),this.onSuccess()},f.prototype.onError=function(a){this.emit("error",a),this.cleanup(!0)},f.prototype.cleanup=function(a){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=d:this.xhr.onreadystatechange=d,a)try{this.xhr.abort()}catch(a){}b.document&&delete f.requests[this.index],this.xhr=null}},f.prototype.onLoad=function(){var a;try{var b;try{b=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(a){}if("application/octet-stream"===b)a=this.xhr.response||this.xhr.responseText;else if(this.supportsBinary)try{a=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(b){for(var c=new Uint8Array(this.xhr.response),d=[],e=0,f=c.length;e<f;e++)d.push(c[e]);a=String.fromCharCode.apply(null,d)}else a=this.xhr.responseText}catch(a){this.onError(a)}null!=a&&this.onData(a)},f.prototype.hasXDR=function(){return"undefined"!=typeof b.XDomainRequest&&!this.xs&&this.enablesXDR},f.prototype.abort=function(){this.cleanup()},f.requestsCount=0,f.requests={},b.document&&(b.attachEvent?b.attachEvent("onunload",g):b.addEventListener&&b.addEventListener("beforeunload",g,!1))}).call(b,function(){return this}())},function(a,b,c){function d(a){var b=a&&a.forceBase64;k&&!b||(this.supportsBinary=!1),e.call(this,a)}var e=c(22),f=c(32),g=c(23),h=c(33),i=c(34),j=c(3)("engine.io-client:polling");a.exports=d;var k=function(){var a=c(18),b=new a({xdomain:!1});return null!=b.responseType}();h(d,e),d.prototype.name="polling",d.prototype.doOpen=function(){this.poll()},d.prototype.pause=function(a){function b(){j("paused"),c.readyState="paused",a()}var c=this;if(this.readyState="pausing",this.polling||!this.writable){var d=0;this.polling&&(j("we are currently polling - waiting to pause"),d++,this.once("pollComplete",function(){j("pre-pause polling complete"),--d||b()})),this.writable||(j("we are currently writing - waiting to pause"),d++,this.once("drain",function(){j("pre-pause writing complete"),--d||b()}))}else b()},d.prototype.poll=function(){j("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},d.prototype.onData=function(a){var b=this;j("polling got data %s",a);var c=function(a,c,d){return"opening"===b.readyState&&b.onOpen(),"close"===a.type?(b.onClose(),!1):void b.onPacket(a)};g.decodePayload(a,this.socket.binaryType,c),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():j('ignoring poll - transport state "%s"',this.readyState))},d.prototype.doClose=function(){function a(){j("writing close packet"),b.write([{type:"close"}])}var b=this;"open"===this.readyState?(j("transport open - closing"),a()):(j("transport not open - deferring close"),this.once("open",a))},d.prototype.write=function(a){var b=this;this.writable=!1;var c=function(){b.writable=!0,b.emit("drain")};g.encodePayload(a,this.supportsBinary,function(a){b.doWrite(a,c)})},d.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",c="";!1!==this.timestampRequests&&(a[this.timestampParam]=i()),this.supportsBinary||a.sid||(a.b64=1),a=f.encode(a),this.port&&("https"===b&&443!==this.port||"http"===b&&80!==this.port)&&(c=":"+this.port),a.length&&(a="?"+a);var d=this.hostname.indexOf(":")!==-1;return b+"://"+(d?"["+this.hostname+"]":this.hostname)+c+this.path+a}},function(a,b,c){function d(a){this.path=a.path,this.hostname=a.hostname,this.port=a.port,this.secure=a.secure,this.query=a.query,this.timestampParam=a.timestampParam,this.timestampRequests=a.timestampRequests,this.readyState="",this.agent=a.agent||!1,this.socket=a.socket,this.enablesXDR=a.enablesXDR,this.pfx=a.pfx,this.key=a.key,this.passphrase=a.passphrase,this.cert=a.cert,this.ca=a.ca,this.ciphers=a.ciphers,this.rejectUnauthorized=a.rejectUnauthorized,this.extraHeaders=a.extraHeaders}var e=c(23),f=c(31);a.exports=d,f(d.prototype),d.prototype.onError=function(a,b){var c=new Error(a);return c.type="TransportError",c.description=b,this.emit("error",c),this},d.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},d.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},d.prototype.send=function(a){if("open"!==this.readyState)throw new Error("Transport not open");this.write(a)},d.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},d.prototype.onData=function(a){var b=e.decodePacket(a,this.socket.binaryType);this.onPacket(b)},d.prototype.onPacket=function(a){this.emit("packet",a)},d.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(a,b,c){(function(a){function d(a,c){var d="b"+b.packets[a.type]+a.data.data;return c(d)}function e(a,c,d){if(!c)return b.encodeBase64Packet(a,d);var e=a.data,f=new Uint8Array(e),g=new Uint8Array(1+e.byteLength);g[0]=s[a.type];for(var h=0;h<f.length;h++)g[h+1]=f[h];return d(g.buffer)}function f(a,c,d){if(!c)return b.encodeBase64Packet(a,d);var e=new FileReader;return e.onload=function(){a.data=e.result,b.encodePacket(a,c,!0,d)},e.readAsArrayBuffer(a.data)}function g(a,c,d){if(!c)return b.encodeBase64Packet(a,d);if(r)return f(a,c,d);var e=new Uint8Array(1);e[0]=s[a.type];var g=new v([e.buffer,a.data]);return d(g)}function h(a){try{a=o.decode(a)}catch(a){return!1}return a}function i(a,b,c){for(var d=new Array(a.length),e=n(a.length,c),f=function(a,c,e){b(c,function(b,c){d[a]=c,e(b,d)})},g=0;g<a.length;g++)f(g,a[g],e)}var j,k=c(24),l=c(25),m=c(26),n=c(27),o=c(28);a&&a.ArrayBuffer&&(j=c(29));var p="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),q="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),r=p||q;b.protocol=3;var s=b.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},t=k(s),u={type:"error",data:"parser error"},v=c(30);b.encodePacket=function(b,c,f,h){"function"==typeof c&&(h=c,c=!1),"function"==typeof f&&(h=f,f=null);var i=void 0===b.data?void 0:b.data.buffer||b.data;if(a.ArrayBuffer&&i instanceof ArrayBuffer)return e(b,c,h);if(v&&i instanceof a.Blob)return g(b,c,h);if(i&&i.base64)return d(b,h);var j=s[b.type];return void 0!==b.data&&(j+=f?o.encode(String(b.data)):String(b.data)),h(""+j)},b.encodeBase64Packet=function(c,d){var e="b"+b.packets[c.type];if(v&&c.data instanceof a.Blob){var f=new FileReader;return f.onload=function(){var a=f.result.split(",")[1];d(e+a)},f.readAsDataURL(c.data)}var g;try{g=String.fromCharCode.apply(null,new Uint8Array(c.data))}catch(a){for(var h=new Uint8Array(c.data),i=new Array(h.length),j=0;j<h.length;j++)i[j]=h[j];g=String.fromCharCode.apply(null,i)}return e+=a.btoa(g),d(e)},b.decodePacket=function(a,c,d){if(void 0===a)return u;if("string"==typeof a){if("b"==a.charAt(0))return b.decodeBase64Packet(a.substr(1),c);if(d&&(a=h(a),a===!1))return u;var e=a.charAt(0);return Number(e)==e&&t[e]?a.length>1?{type:t[e],data:a.substring(1)}:{type:t[e]}:u}var f=new Uint8Array(a),e=f[0],g=m(a,1);return v&&"blob"===c&&(g=new v([g])),{type:t[e],data:g}},b.decodeBase64Packet=function(a,b){var c=t[a.charAt(0)];if(!j)return{type:c,data:{base64:!0,data:a.substr(1)}};var d=j.decode(a.substr(1));return"blob"===b&&v&&(d=new v([d])),{type:c,data:d}},b.encodePayload=function(a,c,d){function e(a){return a.length+":"+a}function f(a,d){b.encodePacket(a,!!g&&c,!0,function(a){d(null,e(a))})}"function"==typeof c&&(d=c,c=null);var g=l(a);return c&&g?v&&!r?b.encodePayloadAsBlob(a,d):b.encodePayloadAsArrayBuffer(a,d):a.length?void i(a,f,function(a,b){return d(b.join(""))}):d("0:")},b.decodePayload=function(a,c,d){if("string"!=typeof a)return b.decodePayloadAsBinary(a,c,d);"function"==typeof c&&(d=c,c=null);var e;if(""==a)return d(u,0,1);for(var f,g,h="",i=0,j=a.length;i<j;i++){var k=a.charAt(i);if(":"!=k)h+=k;else{if(""==h||h!=(f=Number(h)))return d(u,0,1);if(g=a.substr(i+1,f),h!=g.length)return d(u,0,1);if(g.length){if(e=b.decodePacket(g,c,!0),u.type==e.type&&u.data==e.data)return d(u,0,1);var l=d(e,i+f,j);if(!1===l)return}i+=f,h=""}}return""!=h?d(u,0,1):void 0},b.encodePayloadAsArrayBuffer=function(a,c){function d(a,c){b.encodePacket(a,!0,!0,function(a){return c(null,a)})}return a.length?void i(a,d,function(a,b){var d=b.reduce(function(a,b){var c;return c="string"==typeof b?b.length:b.byteLength,a+c.toString().length+c+2},0),e=new Uint8Array(d),f=0;return b.forEach(function(a){var b="string"==typeof a,c=a;if(b){for(var d=new Uint8Array(a.length),g=0;g<a.length;g++)d[g]=a.charCodeAt(g);c=d.buffer}b?e[f++]=0:e[f++]=1;for(var h=c.byteLength.toString(),g=0;g<h.length;g++)e[f++]=parseInt(h[g]);e[f++]=255;for(var d=new Uint8Array(c),g=0;g<d.length;g++)e[f++]=d[g]}),c(e.buffer)}):c(new ArrayBuffer(0))},b.encodePayloadAsBlob=function(a,c){function d(a,c){b.encodePacket(a,!0,!0,function(a){var b=new Uint8Array(1);if(b[0]=1,"string"==typeof a){for(var d=new Uint8Array(a.length),e=0;e<a.length;e++)d[e]=a.charCodeAt(e);a=d.buffer,b[0]=0}for(var f=a instanceof ArrayBuffer?a.byteLength:a.size,g=f.toString(),h=new Uint8Array(g.length+1),e=0;e<g.length;e++)h[e]=parseInt(g[e]);if(h[g.length]=255,v){var i=new v([b.buffer,h.buffer,a]);c(null,i)}})}i(a,d,function(a,b){return c(new v(b))})},b.decodePayloadAsBinary=function(a,c,d){"function"==typeof c&&(d=c,c=null);for(var e=a,f=[],g=!1;e.byteLength>0;){for(var h=new Uint8Array(e),i=0===h[0],j="",k=1;255!=h[k];k++){if(j.length>310){g=!0;break}j+=h[k]}if(g)return d(u,0,1);e=m(e,2+j.length),j=parseInt(j);var l=m(e,0,j);if(i)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(a){var n=new Uint8Array(l);l="";for(var k=0;k<n.length;k++)l+=String.fromCharCode(n[k])}f.push(l),e=m(e,j)}var o=f.length;f.forEach(function(a,e){d(b.decodePacket(a,c,!0),e,o)})}}).call(b,function(){return this}())},function(a,b){a.exports=Object.keys||function(a){var b=[],c=Object.prototype.hasOwnProperty;for(var d in a)c.call(a,d)&&b.push(d);return b}},function(a,b,c){(function(b){function d(a){function c(a){if(!a)return!1;if(b.Buffer&&b.Buffer.isBuffer(a)||b.ArrayBuffer&&a instanceof ArrayBuffer||b.Blob&&a instanceof Blob||b.File&&a instanceof File)return!0;if(e(a)){for(var d=0;d<a.length;d++)if(c(a[d]))return!0}else if(a&&"object"==typeof a){a.toJSON&&(a=a.toJSON());for(var f in a)if(Object.prototype.hasOwnProperty.call(a,f)&&c(a[f]))return!0}return!1}return c(a)}var e=c(9);a.exports=d}).call(b,function(){return this}())},function(a,b){a.exports=function(a,b,c){var d=a.byteLength;if(b=b||0,c=c||d,a.slice)return a.slice(b,c);if(b<0&&(b+=d),c<0&&(c+=d),c>d&&(c=d),b>=d||b>=c||0===d)return new ArrayBuffer(0);for(var e=new Uint8Array(a),f=new Uint8Array(c-b),g=b,h=0;g<c;g++,h++)f[h]=e[g];return f.buffer}},function(a,b){function c(a,b,c){function e(a,d){if(e.count<=0)throw new Error("after called too many times");--e.count,a?(f=!0,b(a),b=c):0!==e.count||f||b(null,d)}var f=!1;return c=c||d,e.count=a,0===a?b():e}function d(){}a.exports=c},function(a,b,c){var d;(function(a,e){!function(f){function g(a){for(var b,c,d=[],e=0,f=a.length;e<f;)b=a.charCodeAt(e++),b>=55296&&b<=56319&&e<f?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function h(a){for(var b,c=a.length,d=-1,e="";++d<c;)b=a[d],b>65535&&(b-=65536,e+=t(b>>>10&1023|55296),b=56320|1023&b),e+=t(b);return e}function i(a,b){return t(a>>b&63|128)}function j(a){if(0==(4294967168&a))return t(a);var b="";return 0==(4294965248&a)?b=t(a>>6&31|192):0==(4294901760&a)?(b=t(a>>12&15|224),b+=i(a,6)):0==(4292870144&a)&&(b=t(a>>18&7|240),b+=i(a,12),b+=i(a,6)),b+=t(63&a|128)}function k(a){for(var b,c=g(a),d=c.length,e=-1,f="";++e<d;)b=c[e],f+=j(b);return f}function l(){if(s>=r)throw Error("Invalid byte index");var a=255&q[s];if(s++,128==(192&a))return 63&a;throw Error("Invalid continuation byte")}function m(){var a,b,c,d,e;if(s>r)throw Error("Invalid byte index");if(s==r)return!1;if(a=255&q[s],s++,0==(128&a))return a;if(192==(224&a)){var b=l();if(e=(31&a)<<6|b,e>=128)return e;throw Error("Invalid continuation byte")}if(224==(240&a)){if(b=l(),c=l(),e=(15&a)<<12|b<<6|c,e>=2048)return e;throw Error("Invalid continuation byte")}if(240==(248&a)&&(b=l(),c=l(),d=l(),e=(15&a)<<18|b<<12|c<<6|d,e>=65536&&e<=1114111))return e;throw Error("Invalid WTF-8 detected")}function n(a){q=g(a),r=q.length,s=0;for(var b,c=[];(b=m())!==!1;)c.push(b);return h(c)}var o="object"==typeof b&&b,p=("object"==typeof a&&a&&a.exports==o&&a,"object"==typeof e&&e);p.global!==p&&p.window!==p||(f=p);var q,r,s,t=String.fromCharCode,u={version:"1.0.0",encode:k,decode:n};d=function(){return u}.call(b,c,b,a),!(void 0!==d&&(a.exports=d))}(this)}).call(b,c(8)(a),function(){return this}())},function(a,b){!function(){"use strict";for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=new Uint8Array(256),d=0;d<a.length;d++)c[a.charCodeAt(d)]=d;b.encode=function(b){var c,d=new Uint8Array(b),e=d.length,f="";for(c=0;c<e;c+=3)f+=a[d[c]>>2],f+=a[(3&d[c])<<4|d[c+1]>>4],f+=a[(15&d[c+1])<<2|d[c+2]>>6],f+=a[63&d[c+2]];return e%3===2?f=f.substring(0,f.length-1)+"=":e%3===1&&(f=f.substring(0,f.length-2)+"=="),f},b.decode=function(a){var b,d,e,f,g,h=.75*a.length,i=a.length,j=0;"="===a[a.length-1]&&(h--,"="===a[a.length-2]&&h--);var k=new ArrayBuffer(h),l=new Uint8Array(k);for(b=0;b<i;b+=4)d=c[a.charCodeAt(b)],e=c[a.charCodeAt(b+1)],f=c[a.charCodeAt(b+2)],g=c[a.charCodeAt(b+3)],l[j++]=d<<2|e>>4,l[j++]=(15&e)<<4|f>>2,l[j++]=(3&f)<<6|63&g;return k}}()},function(a,b){(function(b){function c(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.buffer instanceof ArrayBuffer){var d=c.buffer;if(c.byteLength!==d.byteLength){var e=new Uint8Array(c.byteLength);e.set(new Uint8Array(d,c.byteOffset,c.byteLength)),d=e.buffer}a[b]=d}}}function d(a,b){b=b||{};var d=new f;c(a);for(var e=0;e<a.length;e++)d.append(a[e]);return b.type?d.getBlob(b.type):d.getBlob()}function e(a,b){return c(a),new Blob(a,b||{})}var f=b.BlobBuilder||b.WebKitBlobBuilder||b.MSBlobBuilder||b.MozBlobBuilder,g=function(){try{var a=new Blob(["hi"]);return 2===a.size}catch(a){return!1}}(),h=g&&function(){try{var a=new Blob([new Uint8Array([1,2])]);return 2===a.size}catch(a){return!1}}(),i=f&&f.prototype.append&&f.prototype.getBlob;a.exports=function(){return g?h?b.Blob:e:i?d:void 0}()}).call(b,function(){return this}())},function(a,b){function c(a){if(a)return d(a)}function d(a){for(var b in c.prototype)a[b]=c.prototype[b];return a}a.exports=c,c.prototype.on=c.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks[a]=this._callbacks[a]||[]).push(b),this},c.prototype.once=function(a,b){function c(){d.off(a,c),b.apply(this,arguments)}var d=this;return this._callbacks=this._callbacks||{},c.fn=b,this.on(a,c),this},c.prototype.off=c.prototype.removeListener=c.prototype.removeAllListeners=c.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks[a];if(!c)return this;if(1==arguments.length)return delete this._callbacks[a],this;for(var d,e=0;e<c.length;e++)if(d=c[e],d===b||d.fn===b){c.splice(e,1);break}return this},c.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks[a];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d)c[d].apply(this,b)}return this},c.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks[a]||[]},c.prototype.hasListeners=function(a){return!!this.listeners(a).length}},function(a,b){b.encode=function(a){var b="";for(var c in a)a.hasOwnProperty(c)&&(b.length&&(b+="&"),b+=encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b},b.decode=function(a){for(var b={},c=a.split("&"),d=0,e=c.length;d<e;d++){var f=c[d].split("=");b[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}return b}},function(a,b){a.exports=function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},function(a,b){"use strict";function c(a){var b="";do b=g[a%h]+b,a=Math.floor(a/h);while(a>0);return b}function d(a){var b=0;for(k=0;k<a.length;k++)b=b*h+i[a.charAt(k)];return b}function e(){var a=c(+new Date);return a!==f?(j=0,f=a):a+"."+c(j++)}for(var f,g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),h=64,i={},j=0,k=0;k<h;k++)i[g[k]]=k;e.encode=c,e.decode=d,a.exports=e},function(a,b,c){(function(b){function d(){}function e(a){f.call(this,a),this.query=this.query||{},h||(b.___eio||(b.___eio=[]),h=b.___eio),this.index=h.length;var c=this;h.push(function(a){c.onData(a)}),this.query.j=this.index,b.document&&b.addEventListener&&b.addEventListener("beforeunload",function(){c.script&&(c.script.onerror=d)},!1)}var f=c(21),g=c(33);a.exports=e;var h,i=/\n/g,j=/\\n/g;g(e,f),e.prototype.supportsBinary=!1,e.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),f.prototype.doClose.call(this)},e.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),b.async=!0,b.src=this.uri(),b.onerror=function(b){a.onError("jsonp poll error",b)};var c=document.getElementsByTagName("script")[0];c?c.parentNode.insertBefore(b,c):(document.head||document.body).appendChild(b),this.script=b;var d="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);d&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a),document.body.removeChild(a)},100)},e.prototype.doWrite=function(a,b){function c(){d(),b()}function d(){if(e.iframe)try{e.form.removeChild(e.iframe)}catch(a){e.onError("jsonp polling iframe removal error",a)}try{var a='<iframe src="javascript:0" name="'+e.iframeId+'">';f=document.createElement(a)}catch(a){f=document.createElement("iframe"),f.name=e.iframeId,f.src="javascript:0"}f.id=e.iframeId,e.form.appendChild(f),e.iframe=f}var e=this;if(!this.form){var f,g=document.createElement("form"),h=document.createElement("textarea"),k=this.iframeId="eio_iframe_"+this.index;g.className="socketio",g.style.position="absolute",g.style.top="-1000px",g.style.left="-1000px",g.target=k,g.method="POST",g.setAttribute("accept-charset","utf-8"),h.name="d",g.appendChild(h),document.body.appendChild(g),this.form=g,this.area=h}this.form.action=this.uri(),d(),a=a.replace(j,"\\\n"),this.area.value=a.replace(i,"\\n");try{this.form.submit()}catch(a){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===e.iframe.readyState&&c()}:this.iframe.onload=c}}).call(b,function(){return this}())},function(a,b,c){(function(b){function d(a){var b=a&&a.forceBase64;b&&(this.supportsBinary=!1),this.perMessageDeflate=a.perMessageDeflate,e.call(this,a)}var e=c(22),f=c(23),g=c(32),h=c(33),i=c(34),j=c(3)("engine.io-client:websocket"),k=b.WebSocket||b.MozWebSocket,l=k;if(!l&&"undefined"==typeof window)try{l=c(37)}catch(a){}a.exports=d,h(d,e),d.prototype.name="websocket",d.prototype.supportsBinary=!0,d.prototype.doOpen=function(){if(this.check()){var a=this.uri(),b=void 0,c={agent:this.agent,perMessageDeflate:this.perMessageDeflate};c.pfx=this.pfx,c.key=this.key,c.passphrase=this.passphrase,c.cert=this.cert,c.ca=this.ca,c.ciphers=this.ciphers,c.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(c.headers=this.extraHeaders);try{this.ws=k?new l(a):new l(a,b,c)}catch(a){return this.emit("error",a)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},d.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()},this.ws.onclose=function(){a.onClose()},this.ws.onmessage=function(b){a.onData(b.data)},this.ws.onerror=function(b){a.onError("websocket error",b)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(d.prototype.onData=function(a){var b=this;setTimeout(function(){e.prototype.onData.call(b,a)},0)}),d.prototype.write=function(a){function c(){d.emit("flush"),setTimeout(function(){d.writable=!0,d.emit("drain")},0)}var d=this;this.writable=!1;for(var e=a.length,g=0,h=e;g<h;g++)!function(a){f.encodePacket(a,d.supportsBinary,function(f){if(!k){var g={};if(a.options&&(g.compress=a.options.compress),d.perMessageDeflate){var h="string"==typeof f?b.Buffer.byteLength(f):f.length;h<d.perMessageDeflate.threshold&&(g.compress=!1)}}try{k?d.ws.send(f):d.ws.send(f,g)}catch(a){j("websocket closed before onclose event")}--e||c()})}(a[g])},d.prototype.onClose=function(){e.prototype.onClose.call(this)},d.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},d.prototype.uri=function(){var a=this.query||{},b=this.secure?"wss":"ws",c="";this.port&&("wss"===b&&443!==this.port||"ws"===b&&80!==this.port)&&(c=":"+this.port),this.timestampRequests&&(a[this.timestampParam]=i()),this.supportsBinary||(a.b64=1),a=g.encode(a),a.length&&(a="?"+a);var d=this.hostname.indexOf(":")!==-1;return b+"://"+(d?"["+this.hostname+"]":this.hostname)+c+this.path+a},d.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===d.prototype.name)}}).call(b,function(){return this}())},function(a,b){},function(a,b){var c=[].indexOf;a.exports=function(a,b){if(c)return a.indexOf(b);for(var d=0;d<a.length;++d)if(a[d]===b)return d;return-1}},function(a,b){(function(b){var c=/^[\],:{}\s]*$/,d=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,e=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,f=/(?:^|:|,)(?:\s*\[)+/g,g=/^\s+/,h=/\s+$/;a.exports=function(a){return"string"==typeof a&&a?(a=a.replace(g,"").replace(h,""),b.JSON&&JSON.parse?JSON.parse(a):c.test(a.replace(d,"@").replace(e,"]").replace(f,""))?new Function("return "+a)():void 0):null}}).call(b,function(){return this}())},function(a,b,c){"use strict";function d(a,b,c){this.io=a,this.nsp=b,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,c&&c.query&&(this.query=c.query),this.io.autoConnect&&this.open()}var e=c(6),f=c(41),g=c(42),h=c(43),i=c(44),j=c(3)("socket.io-client:socket"),k=c(45);a.exports=b=d;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},m=f.prototype.emit;f(d.prototype),d.prototype.subEvents=function(){if(!this.subs){var a=this.io;this.subs=[h(a,"open",i(this,"onopen")),h(a,"packet",i(this,"onpacket")),h(a,"close",i(this,"onclose"))]}},d.prototype.open=d.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},d.prototype.send=function(){var a=g(arguments);return a.unshift("message"),this.emit.apply(this,a),this},d.prototype.emit=function(a){if(l.hasOwnProperty(a))return m.apply(this,arguments),this;var b=g(arguments),c=e.EVENT;k(b)&&(c=e.BINARY_EVENT);var d={type:c,data:b};return d.options={},d.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof b[b.length-1]&&(j("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),d.id=this.ids++),this.connected?this.packet(d):this.sendBuffer.push(d),delete this.flags,this},d.prototype.packet=function(a){a.nsp=this.nsp,this.io.packet(a)},d.prototype.onopen=function(){j("transport is open - connecting"),"/"!==this.nsp&&(this.query?this.packet({type:e.CONNECT,query:this.query}):this.packet({type:e.CONNECT}))},d.prototype.onclose=function(a){j("close (%s)",a),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",a)},d.prototype.onpacket=function(a){if(a.nsp===this.nsp)switch(a.type){case e.CONNECT:this.onconnect();break;case e.EVENT:this.onevent(a);break;case e.BINARY_EVENT:this.onevent(a);break;case e.ACK:this.onack(a);break;case e.BINARY_ACK:this.onack(a);break;case e.DISCONNECT:this.ondisconnect();break;case e.ERROR:this.emit("error",a.data)}},d.prototype.onevent=function(a){var b=a.data||[];j("emitting event %j",b),null!=a.id&&(j("attaching ack callback to event"),b.push(this.ack(a.id))),this.connected?m.apply(this,b):this.receiveBuffer.push(b)},d.prototype.ack=function(a){var b=this,c=!1;return function(){if(!c){c=!0;var d=g(arguments);j("sending ack %j",d);var f=k(d)?e.BINARY_ACK:e.ACK;b.packet({type:f,id:a,data:d})}}},d.prototype.onack=function(a){var b=this.acks[a.id];"function"==typeof b?(j("calling ack %s with %j",a.id,a.data),b.apply(this,a.data),delete this.acks[a.id]):j("bad ack %s",a.id)},d.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered();
},d.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)m.apply(this,this.receiveBuffer[a]);for(this.receiveBuffer=[],a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);this.sendBuffer=[]},d.prototype.ondisconnect=function(){j("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},d.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)},d.prototype.close=d.prototype.disconnect=function(){return this.connected&&(j("performing disconnect (%s)",this.nsp),this.packet({type:e.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},d.prototype.compress=function(a){return this.flags=this.flags||{},this.flags.compress=a,this}},function(a,b){function c(a){if(a)return d(a)}function d(a){for(var b in c.prototype)a[b]=c.prototype[b];return a}a.exports=c,c.prototype.on=c.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks["$"+a]=this._callbacks["$"+a]||[]).push(b),this},c.prototype.once=function(a,b){function c(){this.off(a,c),b.apply(this,arguments)}return c.fn=b,this.on(a,c),this},c.prototype.off=c.prototype.removeListener=c.prototype.removeAllListeners=c.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks["$"+a];if(!c)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;for(var d,e=0;e<c.length;e++)if(d=c[e],d===b||d.fn===b){c.splice(e,1);break}return this},c.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=[].slice.call(arguments,1),c=this._callbacks["$"+a];if(c){c=c.slice(0);for(var d=0,e=c.length;d<e;++d)c[d].apply(this,b)}return this},c.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]},c.prototype.hasListeners=function(a){return!!this.listeners(a).length}},function(a,b){function c(a,b){var c=[];b=b||0;for(var d=b||0;d<a.length;d++)c[d-b]=a[d];return c}a.exports=c},function(a,b){"use strict";function c(a,b,c){return a.on(b,c),{destroy:function(){a.removeListener(b,c)}}}a.exports=c},function(a,b){var c=[].slice;a.exports=function(a,b){if("string"==typeof b&&(b=a[b]),"function"!=typeof b)throw new Error("bind() requires a function");var d=c.call(arguments,2);return function(){return b.apply(a,d.concat(c.call(arguments)))}}},function(a,b,c){(function(b){function d(a){function c(a){if(!a)return!1;if(b.Buffer&&b.Buffer.isBuffer&&b.Buffer.isBuffer(a)||b.ArrayBuffer&&a instanceof ArrayBuffer||b.Blob&&a instanceof Blob||b.File&&a instanceof File)return!0;if(e(a)){for(var d=0;d<a.length;d++)if(c(a[d]))return!0}else if(a&&"object"==typeof a){a.toJSON&&"function"==typeof a.toJSON&&(a=a.toJSON());for(var f in a)if(Object.prototype.hasOwnProperty.call(a,f)&&c(a[f]))return!0}return!1}return c(a)}var e=c(9);a.exports=d}).call(b,function(){return this}())},function(a,b){function c(a){a=a||{},this.ms=a.min||100,this.max=a.max||1e4,this.factor=a.factor||2,this.jitter=a.jitter>0&&a.jitter<=1?a.jitter:0,this.attempts=0}a.exports=c,c.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),c=Math.floor(b*this.jitter*a);a=0==(1&Math.floor(10*b))?a-c:a+c}return 0|Math.min(a,this.max)},c.prototype.reset=function(){this.attempts=0},c.prototype.setMin=function(a){this.ms=a},c.prototype.setMax=function(a){this.max=a},c.prototype.setJitter=function(a){this.jitter=a}}])});var ipushpull;!function(a){"use strict";var b=function(){function a(){}return a.prototype.set=function(a){var b={api_url:"https://www.ipushpull.com/api/1.0",ws_url:"https://www.ipushpull.com",storage_prefix:""};if(a.api_url&&!a.ws_url){var c=a.api_url.split("/");b.ws_url=c[0]+"//"+c[2]}this._config=angular.merge({},b,a)},a.prototype.$get=function(){return this._config},a}();a.module=angular.module("ipushpull",[]).provider("ippConfig",b)}(ipushpull||(ipushpull={}));var ipushpull;!function(a){"use strict";var b=function(){function a(a,b){this._headers={},this._cache=!1,this._overrideLock=!1,this._method=a,this._url=b,this._headers={"Content-Type":"application/json","x-requested-with":"XMLHttpRequest","x-ipp-device-uuid":"","x-ipp-client":"","x-ipp-client-version":""}}return a.get=function(b){return new a("GET",b)},a.post=function(b){return new a("POST",b)},a.put=function(b){return new a("PUT",b)},a.del=function(b){return new a("DELETE",b)},Object.defineProperty(a.prototype,"METHOD",{get:function(){return this._method},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"URL",{get:function(){return this._url},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"HEADERS",{get:function(){return this._headers},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"DATA",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"PARAMS",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"CACHE",{get:function(){return this._cache},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"OVERRIDE_LOCK",{get:function(){return this._overrideLock},enumerable:!0,configurable:!0}),a.prototype.method=function(a){return this._method=a,this},a.prototype.url=function(a){return this._url=a,this},a.prototype.headers=function(a,b){return void 0===b&&(b=!1),this._headers=b?a:angular.merge({},this._headers,a),this},a.prototype.data=function(a){return this._data=a,this},a.prototype.params=function(a,b){return void 0===b&&(b=!1),this._params=b?a:angular.merge({},this._params,a),this},a.prototype.cache=function(a){return a&&"GET"===this._method&&(this._cache=a),this},a.prototype.overrideLock=function(a){return void 0===a&&(a=!0),this._overrideLock=a,this},a}(),c=function(){function a(a,b,c,d,e,f){var g=this;this.$http=a,this.$httpParamSerializerJQLike=b,this.$q=c,this.$injector=d,this.storage=e,this.config=f,this._locked=!1,this.dummyRequest=function(a){var b=g.$q.defer();return b.reject({data:{},status:666,statusText:"Api is locked",config:a}),b.promise},this.handleSuccess=function(a){var b=g.$q.defer();return b.resolve({success:!0,data:a.data,httpCode:parseInt(a.status,10),httpText:a.statusText}),b.promise},this.handleError=function(a){var b=g.$q.defer();if(401===parseInt(a.status,10)&&!g._locked&&"invalid_grant"!==a.data.error){var c=g.$injector.get("ippAuthService");c.emit(c.EVENT_401)}return b.reject({success:!1,data:a.data,httpCode:parseInt(a.status,10),httpText:a.statusText}),b.promise},this._endPoint=""+this.config.api_url}return a.prototype.block=function(){this._locked=!0},a.prototype.unblock=function(){this._locked=!1},a.prototype.getSelfInfo=function(){return this.send(b.get(this._endPoint+"/users/self/").cache(!1).overrideLock())},a.prototype.refreshAccessTokens=function(a){return this.send(b.post(this._endPoint+"/oauth/token/").data(this.$httpParamSerializerJQLike({grant_type:"refresh_token",client_id:this.config.api_key,client_secret:this.config.api_secret,refresh_token:a})).headers({"Content-Type":"application/x-www-form-urlencoded"}).overrideLock())},a.prototype.userLogin=function(a){return this.send(b.post(this._endPoint+"/oauth/token/").data(this.$httpParamSerializerJQLike({grant_type:"password",client_id:this.config.api_key,client_secret:this.config.api_secret,username:a.email,password:a.password})).headers({"Content-Type":"application/x-www-form-urlencoded"}))},a.prototype.getDomains=function(){return this.send(b.get(this._endPoint+"/domains/"))},a.prototype.getDomain=function(a){return this.send(b.get(this._endPoint+"/domains/"+a+"/"))},a.prototype.createFolder=function(a){return this.send(b.post(this._endPoint+"/domains/").data(a.data))},a.prototype.updateDomain=function(a){return this.send(b.put(this._endPoint+"/domains/"+a.domainId+"/").data(a.data))},a.prototype.getDomainPages=function(a){return this.send(b.get(this._endPoint+"/domains/"+a+"/page_access/"))},a.prototype.getDomainsAndPages=function(){return this.send(b.get(this._endPoint+"/domain_page_access/"))},a.prototype.getPage=function(a){return this.send(b.get(this._endPoint+"/domains/id/"+a.domainId+"/page_content/id/"+a.pageId+"/").params({client_seq_no:a.seq_no}))},a.prototype.getPageByName=function(a){return this.send(b.get(this._endPoint+"/domains/name/"+a.domainId+"/page_content/name/"+a.pageId+"/").params({client_seq_no:a.seq_no}))},a.prototype.getPageAccess=function(a){return this.send(b.get(this._endPoint+"/domains/id/"+a.domainId+"/page_access/id/"+a.pageId+"/"))},a.prototype.createPage=function(a){return this.send(b.post(this._endPoint+"/domains/"+a.domainId+"/pages/").data(a.data))},a.prototype.savePageContent=function(a){return this.send(b.put(this._endPoint+"/domains/id/"+a.domainId+"/page_content/id/"+a.pageId+"/").data(a.data))},a.prototype.savePageContentDelta=function(a){return this.send(b.put(this._endPoint+"/domains/id/"+a.domainId+"/page_content_delta/id/"+a.pageId+"/").data(a.data))},a.prototype.savePageSettings=function(a){return this.send(b.put(this._endPoint+"/domains/"+a.domainId+"/pages/"+a.pageId+"/").data(a.data))},a.prototype.deletePage=function(a){return this.send(b.del(this._endPoint+"/domains/"+a.domainId+"/pages/"+a.pageId+"/"))},a.prototype.saveUserInfo=function(a){return this.send(b.put(this._endPoint+"/users/self/").data(a))},a.prototype.getUserMetaData=function(a){return this.send(b.get(this._endPoint+"/users/"+a.userId+"/meta/").data(a.data))},a.prototype.saveUserMetaData=function(a){return this.send(b.put(this._endPoint+"/users/"+a.userId+"/meta/").data(a.data))},a.prototype.deleteUserMetaData=function(a){return this.send(b.delete(this._endPoint+"/users/"+a.userId+"/meta/").data(a.data))},a.prototype.changePassword=function(a){return this.send(b.put(this._endPoint+"/credentials/self/").data(a))},a.prototype.changeEmail=function(a){return this.send(b.put(this._endPoint+"/credentials/self/").data(a))},a.prototype.forgotPassword=function(a){return this.send(b.post(this._endPoint+"/password_reset/").data(a))},a.prototype.resetPassword=function(a){return this.send(b.post(this._endPoint+"/password_reset/confirm/").data(a))},a.prototype.inviteUsers=function(a){return this.send(b.post(this._endPoint+"/domains/"+a.domainId+"/invitations/").data(a.data))},a.prototype.acceptInvitation=function(a){return this.send(b.post(this._endPoint+"/users/invitation/confirm/").data(a))},a.prototype.refuseInvitation=function(a){return this.send(b.del(this._endPoint+"/users/invitation/confirm/").data(a))},a.prototype.domainInvitations=function(a){return this.send(b.get(this._endPoint+"/domains/"+a.domainId+"/invitations/").params({is_complete:"False"}))},a.prototype.userInvitations=function(){return this.send(b.get(this._endPoint+"/users/self/invitations/").params({is_complete:"False"}))},a.prototype.domainAccessLog=function(a){return this.send(b.get(this._endPoint+"/domain_access/"+a.domainId+"/events/").params({page_size:a.limit}))},a.prototype.domainUsers=function(a){return this.send(b.get(this._endPoint+"/domain_access/"+a.domainId+"/users/"))},a.prototype.activateUser=function(a){return this.send(b.post(this._endPoint+"/users/signup/confirm/").data(a))},a.prototype.setDomainDefault=function(a){return this.send(b.put(this._endPoint+"/domain_access/"+a.domainId+"/users/self/").data(a.data))},a.prototype.resendInvite=function(a){return this.send(b.put(this._endPoint+"/domains/"+a.domainId+"/invitations/"+a.inviteId+"/resend/"))},a.prototype.updateDomainAccess=function(a){return this.send(b.put(this._endPoint+"/domain_access/"+a.domainId+"/users/").data(a.data))},a.prototype.removeUsersFromDomain=function(a){return this.send(b.del(this._endPoint+"/domain_access/"+a.domainId+"/users/").data(a.data))},a.prototype.getInvitation=function(a){return this.send(b.get(this._endPoint+"/users/invitations/"+a.token+"/"))},a.prototype.cancelInvitations=function(a){return this.send(b.del(this._endPoint+"/domains/"+a.domainId+"/invitations/").data(a.data))},a.prototype.getDomainAccessGroups=function(a){return this.send(b.get(this._endPoint+"/domains/"+a.domainId+"/access_groups/"))},a.prototype.getDomainAccessGroup=function(a){return this.send(b.get(this._endPoint+"/domains/"+a.domainId+"/access_groups/"+a.groupId+"/"))},a.prototype.addDomainAccessGroup=function(a){return this.send(b.post(this._endPoint+"/domains/"+a.domainId+"/access_groups/").data(a.data))},a.prototype.putDomainAgroupMembers=function(a){return this.send(b.post(this._endPoint+"/domains/"+a.domainId+"/access_groups/"+a.agroupId+"/members/").data(a.data))},a.prototype.putDomainAgroupPages=function(a){return this.send(b.post(this._endPoint+"/domains/"+a.domainId+"/access_groups/"+a.agroupId+"/pages/").data(a.data))},a.prototype.updateDomainAgroup=function(a){return this.send(b.put(this._endPoint+"/domains/"+a.domainId+"/access_groups/"+a.agroupId+"/").data(a.data))},a.prototype.deleteDomainAGroup=function(a){return this.send(b.del(this._endPoint+"/domains/"+a.domainId+"/access_groups/"+a.agroupId+"/"))},a.prototype.getDomainPageAccess=function(a){return this.send(b.get(this._endPoint+"/domain_page_access/"+a.domainId+"/"))},a.prototype.getDomainCustomers=function(a){return this.send(b.get(this._endPoint+"/domains/"+a.domainId+"/customers/"))},a.prototype.saveDomainPageAccess=function(a){return this.send(b.put(this._endPoint+"/domain_page_access/"+a.domainId+"/basic/").data(a.data))},a.prototype.getTemplates=function(a){return this.send(b.get(this._endPoint+"/templates/"))},a.prototype.saveCustomer=function(a){return this.send(b.post(this._endPoint+"/domains/"+a.domainId+"/customers/").data(a.data))},a.prototype.updateCustomer=function(a){return this.send(b.put(this._endPoint+"/domains/"+a.domainId+"/customers/"+a.data.id+"/").data(a.data))},a.prototype.removeCustomer=function(a){return this.send(b.del(this._endPoint+"/domains/"+a.domainId+"/customers/"+a.customerId+"/"))},a.prototype.getDocEmailRules=function(a){return this.send(b.get(this._endPoint+"/domains/"+a.domainId+"/docsnames/"))},a.prototype.createDocEmailRule=function(a){return this.send(b.post(this._endPoint+"/domains/"+a.domainId+"/docsnames/").data(a.data))},a.prototype.updateDocEmailRule=function(a){return this.send(b.put(this._endPoint+"/domains/"+a.domainId+"/docsnames/"+a.docRuleId+"/").data(a.data))},a.prototype.deleteDocEmailRule=function(a){return this.send(b.del(this._endPoint+"/domains/"+a.domainId+"/docsnames/"+a.docRuleId+"/"))},a.prototype.send=function(a){var b=this.storage.persistent.get("access_token");a.headers({Authorization:"Bearer "+(b?b:"null")});var c=this._locked&&!a.OVERRIDE_LOCK?this.dummyRequest:this.$http;a.cache(!1);var d=c({url:a.URL,cache:a.CACHE,method:a.METHOD,params:a.PARAMS,data:a.DATA,headers:a.HEADERS});return d.then(this.handleSuccess,this.handleError)},a.$inject=["$http","$httpParamSerializerJQLike","$q","$injector","ippStorageService","ippConfig"],a}();a.module.service("ippApiService",c)}(ipushpull||(ipushpull={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},ipushpull;!function(a){"use strict";var b=function(b){function c(a,c,d,e,f){var g=this;b.call(this),this.$q=a,this.$timeout=c,this.ippApi=d,this.storage=e,this.config=f,this._user={},this._authenticated=!1,this._authInProgress=!1,this._selfTimeout=15e3,this.on401=function(){g.ippApi.block(),g.storage.persistent.remove("access_token"),g.emit(g.EVENT_RE_LOGGING),g.authenticate(!0).then(function(){g.storage.user.suffix=g._user.id,g.emit(g.EVENT_LOGIN_REFRESHED)},function(){g.emit(g.EVENT_ERROR)}).finally(function(){g.ippApi.unblock()})},this.on(this.EVENT_401,this.on401)}return __extends(c,b),Object.defineProperty(c.prototype,"EVENT_LOGGED_IN",{get:function(){return"logged_in"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"EVENT_RE_LOGGING",{get:function(){return"re_logging"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"EVENT_LOGIN_REFRESHED",{get:function(){return"login_refreshed"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"EVENT_LOGGED_OUT",{get:function(){return"logged_out"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"EVENT_ERROR",{get:function(){return"error"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"EVENT_401",{get:function(){return"401"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"EVENT_USER_UPDATED",{get:function(){return"user_updated"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"user",{get:function(){return this._user},enumerable:!0,configurable:!0}),c.prototype.authenticate=function(a){var b=this;void 0===a&&(a=!1);var c=this.$q.defer();return this._authInProgress?(c.reject("Auth already in progress"),c.promise):(this._authInProgress=!0,this._authenticated&&!a?(this._authInProgress=!1,c.resolve(),c.promise):(this.processAuth().then(function(a){b._authenticated||(b._authenticated=!0,b.storage.user.suffix=b._user.id,b.emit(b.EVENT_LOGGED_IN),b.startPollingSelf()),c.resolve()},function(a){b.emit(b.EVENT_ERROR,a),b._authenticated&&b.logout(),c.reject(a)}).finally(function(){b._authInProgress=!1}),c.promise))},c.prototype.login=function(b,c){var d=this,e=this.$q.defer();return this.ippApi.userLogin({grant_type:"password",client_id:this.config.api_key,client_secret:this.config.api_secret,email:b,password:c}).then(function(a){d.saveTokens(a.data),d.authenticate().then(e.resolve,e.reject)},function(b){if(b.message="",400===b.httpCode||401===b.httpCode)switch(b.data.error){case"invalid_grant":b.message="The username and password you entered did not match our records. Please double-check and try again.";break;case"invalid_client":b.message="Your client doesn't have access to iPushPull system.";break;case"invalid_request":b.message=b.data.error_description;break;default:b.message=a.Utils.parseApiError(b.data,"Unknown error")}d.emit(d.EVENT_ERROR,b),e.reject(b)}),e.promise},c.prototype.logout=function(){this.storage.persistent.remove("access_token"),this.storage.persistent.remove("refresh_token"),this._authenticated=!1,this.$timeout.cancel(this._selfTimer),this.storage.user.suffix="GUEST",this.emit(this.EVENT_LOGGED_OUT)},c.prototype.processAuth=function(){var a=this,b=this.$q.defer(),c=this.storage.persistent.get("access_token"),d=this.storage.persistent.get("refresh_token");return c?this.getUserInfo():(d?this.refreshTokens().then(function(c){a.saveTokens(c.data),a.getUserInfo().then(b.resolve,b.reject)},function(c){a.storage.persistent.remove("refresh_token"),b.reject(c)}):b.reject("No tokens available"),b.promise)},c.prototype.refreshTokens=function(){var a=this.storage.persistent.get("refresh_token");return this.ippApi.refreshAccessTokens(a)},c.prototype.saveTokens=function(a){this.storage.persistent.create("access_token",a.access_token,a.expires_in/86400),this.storage.persistent.create("refresh_token",a.refresh_token,365)},c.prototype.getUserInfo=function(){var a=this,b=this.$q.defer();return this.ippApi.getSelfInfo().then(function(c){angular.equals(a._user,c.data)||(a._user=c.data,a.emit(a.EVENT_USER_UPDATED)),b.resolve()},b.reject),b.promise},c.prototype.startPollingSelf=function(){var a=this;this.$timeout.cancel(this._selfTimer),this._selfTimer=this.$timeout(function(){a.getUserInfo().then(angular.noop,angular.noop).finally(function(){a.startPollingSelf()})},this._selfTimeout)},c.$inject=["$q","$timeout","ippApiService","ippStorageService","ippConfig"],c}(EventEmitter);a.module.service("ippAuthService",b)}(ipushpull||(ipushpull={}));var ipushpull;!function(a){"use strict";var b=function(){function a(){}return a._instance=function(){return new a},a.prototype.decryptContent=function(a,b){if(this.libCheck()&&b){var c=forge.util.decode64(b),d=c.substring(0,16),e=c.substring(16);e=forge.util.createBuffer(e,"latin1"),d=forge.util.createBuffer(d,"latin1");var f=forge.cipher.createDecipher("AES-CBC",this.hashPassphrase(a.passphrase));f.start({iv:d}),f.update(e);var g;f.finish();try{g=JSON.parse(f.output.toString())}catch(a){g=void 0}return g}},a.prototype.encryptContent=function(a,b){if(this.libCheck()){var c=JSON.stringify(b),d=this.hashPassphrase(a.passphrase),e=forge.random.getBytesSync(16),f=forge.cipher.createCipher("AES-CBC",d);f.start({iv:e}),f.update(forge.util.createBuffer(c,"utf8")),f.finish();var g=f.output,h=forge.util.createBuffer();h.putBytes(e),h.putBytes(g.bytes());var i=h.getBytes();return forge.util.encode64(i)}},a.prototype.hashPassphrase=function(a){var b=forge.md.sha256.create();return b.update(a),b.digest().bytes()},a.prototype.libCheck=function(){return"undefined"==typeof forge,"undefined"!=typeof forge},a}();a.module.factory("ippCryptoService",b._instance)}(ipushpull||(ipushpull={}));var ipushpull;!function(a){"use strict"}(ipushpull||(ipushpull={}));var ipushpull;!function(a){"use strict";var b=function(){function b(b){this.canDoDelta=!0,this._original=[[]],this._current=[[]],this._newRows=[],this._newCols=[],b&&b.constructor===Array&&b.length&&b[0].length||(b=[[{value:"",formatted_value:""}]],this.canDoDelta=!1),this._original=a.Utils.clonePageContent(b),this._current=c.decompressStyles(b)}return Object.defineProperty(b.prototype,"current",{get:function(){return this._current},enumerable:!0,configurable:!0}),b.prototype.update=function(b){this._original=a.Utils.clonePageContent(b);var d=a.Utils.clonePageContent(this._current);if(b.length<d.length&&(d.splice(b.length-1,d.length-b.length),this._newRows=this._newRows.filter(function(a){return a<b.length})),b[0].length<d[0].length)for(var e=d[0].length-b[0].length,f=0;f<d.length;f++)d[f].splice(b[0].length-1,e);for(var f=0;f<this._newRows.length;f++)b.splice(this._newRows[f],0,d[f]);for(var f=0;f<this._newCols.length;f++)for(var g=0;g<b.length;g++)this._newRows.indexOf(g)>=0||g>=d.length||b[g].splice(this._newCols[f],0,d[g][f]);for(var f=0;f<b.length;f++)if(d[f])for(var g=0;g<b[f].length;g++)d[f][g]?d[f][g].dirty||(d[f][g]=b[f][g]):d[f].push(b[f][g]);else d.push(b[f]);d[0].length||(d[0][0]={value:"",formatted_value:""}),this._current=c.decompressStyles(d)},b.prototype.reset=function(){for(var a=0;a<this._newRows.length;a++)this._current.splice(this._newRows[a],1);for(var a=0;a<this._newCols.length;a++)for(var b=0;b<this._current.length;b++)this._current[b].splice(this._newCols[a],1);this.cleanDirty(),this.update(this._original)},b.prototype.getCell=function(a,b){if(!this._current[a])throw new Error("row out of bounds");if(!this._current[a][b])throw new Error("column out of bounds");return this._current[a][b]},b.prototype.updateCell=function(a,b,c){if(!this._current[a])throw new Error("row out of bounds");if(!this._current[a][b])throw new Error("column out of bounds");this._original[a]&&this._original[a][b]?c.dirty=this._original[a][b].formatted_value!==c.formatted_value:c.dirty=!0,angular.merge(this._current[a][b],c)},b.prototype.addRow=function(a){a||(a=this._current.length);var b=[];if(this._current.length){b=angular.copy(this._current[a-1]);for(var c=0;c<b.length;c++)b[c].value="",b[c].formatted_value="",b[c].style=b[c].style?b[c].style:{},b[c].dirty=!0}this._current.splice(a,0,b);for(var c=0;c<this._newRows.length;c++)this._newRows[c]>=a&&this._newRows[c]++;return this._newRows.push(a),b},b.prototype.addColumn=function(a){if(a||(a=this._current.length?this._current[0].length:0),!this._current.length)return void this.addRow(0);for(var b=0;b<this._current.length;b++){var c={value:"",formatted_value:"",style:a?angular.copy(this._current[b][a-1].style):{},dirty:!0};this._current[b].splice(a,0,c)}for(var b=0;b<this._newCols.length;b++)this._newCols[b]>=a&&this._newCols[b]++;this._newCols.push(a)},b.prototype.removeRow=function(){this.canDoDelta=!1},b.prototype.removeColumn=function(){this.canDoDelta=!1},b.prototype.getDelta=function(){var b=c.compressStyles(a.Utils.clonePageContent(this._current)),d={new_rows:[],new_cols:[],content_delta:[{row_index:0,cols:[{col_index:0,cell_content:{value:""}}]}]};d.content_delta=[],d.new_rows=this._newRows,d.new_cols=this._newCols;for(var e=0,f=0,g=0;g<b.length;g++){var h={},i=this._newRows.indexOf(g)>=0;f=0,i&&(h={row_index:g,cols:[]},e++);for(var j=0;j<b[g].length;j++)if(i){var k=angular.copy(b[g][j]);delete k.dirty,h.cols.push({col_index:j,cell_content:k})}else{var l=this._newCols.indexOf(j)>=0;if(l&&f++,l||b[g][j].dirty){Object.keys(h).length||(h={row_index:g,cols:[]});var k=angular.copy(b[g][j]);delete k.dirty,h.cols.push({col_index:j,cell_content:k})}}Object.keys(h).length&&d.content_delta.push(h)}return d},b.prototype.getFull=function(){for(var b=a.Utils.clonePageContent(this._current),d=0;d<b.length;d++)for(var e=0;e<b[d].length;e++)delete b[d][e].dirty;return c.compressStyles(b)},b.prototype.cleanDirty=function(){for(var a=0;a<this._current.length;a++)for(var b=0;b<this._current[a].length;b++)delete this._current[a][b].dirty;this._newCols=[],this._newRows=[],this.canDoDelta=!0},b}();a.PageContent=b;var c=function(){function a(){this.currentStyle={},this.currentBorders={top:{},right:{},bottom:{},left:{}},this.excelStyles={"text-wrap":"white-space",tbs:"border-top-style",rbs:"border-right-style",bbs:"border-bottom-style",lbs:"border-left-style",tbc:"border-top-color",rbc:"border-right-color",bbc:"border-bottom-color",lbc:"border-left-color",tbw:"border-top-width",rbw:"border-right-width",bbw:"border-bottom-width",lbw:"border-left-width"},this.excelBorderStyles={solid:"solid",thin:"solid",thick:"solid",hair:"solid",dash:"dashed",dashed:"dashed",dashdot:"dashed",mediumdashed:"dashed",mediumdashdot:"dashed",slantdashdot:"dashed",dot:"dotted",dotted:"dotted",hairline:"dotted",mediumdashdotdot:"dotted",dashdotdot:"dotted",double:"double"},this.excelBorderWeights={thin:"1px",medium:"1px",thick:"2px",hair:"1px",hairline:"1px",double:"3px"},this.ignoreStyles=["number-format"]}return a.decompressStyles=function(b){for(var c=new a,d=0;d<b.length;d++)for(var e=0;e<b[d].length;e++)b[d][e].style=c.makeStyle(b[d][e].style);return b},a.compressStyles=function(b){for(var c=new a,d=0;d<b.length;d++)for(var e=0;e<b[d].length;e++)b[d][e].style=c.reverseCellStyle(b[d][e].style);return c.cleanUpReversed(b)},a.prototype.reset=function(){this.currentStyle={},this.currentBorders={top:{},right:{},bottom:{},left:{}}},a.prototype.makeStyle=function(a){var b,c=angular.copy(a);for(var d in c)if(c.hasOwnProperty(d)&&!(this.ignoreStyles.indexOf(d)>=0)){b=this.excelToCSS(d);var e="",f="";if(("color"===b||"background-color"===b)&&"none"!==c[d]&&c[d].indexOf("#")<0&&(e="#"),"white-space"===b&&(c[d]="normal"===c[d]?"pre":"pre-wrap"),0!==b.indexOf("border"))this.currentStyle[b]=e+c[d]+f;else{var g=b.split("-")[1];b.indexOf("-style")>=0&&(this.currentBorders[g].style=this.excelBorderStyles[c[d]]||void 0),b.indexOf("-width")>=0&&(this.currentBorders[g].width="none"!==c[d]?this.excelBorderWeights[c[d]]:void 0),b.indexOf("-color")>=0&&(this.currentBorders[g].color="none"===c[d]?"transparent":"#"+c[d])}}var h=angular.copy(this.currentStyle);for(var i in this.currentBorders)"undefined"!=typeof this.currentBorders[i].style&&this.currentBorders[i].style&&(h["border-"+i]=this.currentBorders[i].width+" "+this.currentBorders[i].style+" "+this.currentBorders[i].color);return h},a.prototype.reverseCellStyle=function(a,b){void 0===b&&(b=!0);var c={};for(var d in a)if(a.hasOwnProperty(d))if(d.indexOf("border")<0)"color"!==d&&"background-color"!==d||(a[d]=a[d].replace("#","")),"font-family"===d&&(a[d]=a[d].split(",")[0]),c[this.CSSToExcel(d)]=a[d].trim();else{var e=d.split("-")[1].charAt(0),f=a[d].split(" ");c[e+"bw"]=this.excelBorderWeight(f[0]),c[e+"bs"]=f[1],c[e+"bc"]=f[2].replace("#","")}if(b)for(var g in this.excelStyles)this.excelStyles.hasOwnProperty(g)&&"text-wrap"!==g&&(c[g]||(c[g]="none"));return c},a.prototype.cleanUpReversed=function(a){for(var b={},c=0;c<a.length;c++)for(var d=0;d<a[c].length;d++){var e=angular.copy(a[c][d].style);for(var f in e)e.hasOwnProperty(f)&&(b[f]&&b[f]===e[f]?delete a[c][d].style[f]:b[f]=e[f]);Object.keys(a[c][d].style).length||delete a[c][d].style}return a},a.prototype.excelToCSS=function(a){return this.excelStyles[a]?this.excelStyles[a]:a},a.prototype.CSSToExcel=function(a){var b=a;for(var c in this.excelStyles)if(this.excelStyles[c]===a){b=c;break}return b},a.prototype.excelBorderWeight=function(a){var b="";for(var c in this.excelBorderWeights)if(this.excelBorderWeights.hasOwnProperty(c)&&this.excelBorderWeights[c]===a){b=c;break}return b},a.prototype.rgbToHex=function(a){a=a.replace("rgb(","").replace(")","");var b=a.split(",");return this.componentToHex(parseInt(b[0],10))+this.componentToHex(parseInt(b[1],10))+this.componentToHex(parseInt(b[2],10))},a.prototype.componentToHex=function(a){var b=a.toString(16);return 1===b.length?"0"+b:b},a}()}(ipushpull||(ipushpull={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},ipushpull;!function(a){"use strict"}(ipushpull||(ipushpull={}));var ipushpull;!function(a){"use strict";var b,c,d,e,f,g,h,i,j=function(){function a(a,j,l,m,n,o,p,q){return b=a,c=j,d=l,e=m,f=n,g=o,h=p,i=q,k}return a.$inject=["$q","$timeout","$interval","ippApiService","ippAuthService","ippStorageService","ippCryptoService","ippConfig"],a}();a.module.service("ippPageService",j);var k=function(c){function f(a,b){var d=this;c.call(this),this.ready=!1,this.decrypted=!0,this.updatesOn=!0,this._supportsWS=!0,this._encryptionKeyPull={name:"",passphrase:""},this._encryptionKeyPush={name:"",passphrase:""},this.onPageError=function(a){a.code=a.httpCode||a.code,a.message=a.httpText||a.message,d.emit(d.EVENT_ERROR,a),404===a.code&&d.destroy()},this.types={regular:this.TYPE_REGULAR,pageAccessReport:this.TYPE_PAGE_ACCESS_REPORT,domainUsageReport:this.TYPE_DOMAIN_USAGE_REPORT,globalUsageReport:this.TYPE_GLOBAL_USAGE_REPORT,pageUpdateReport:this.TYPE_PAGE_UPDATE_REPORT,alert:this.TYPE_ALERT,pdf:this.TYPE_PDF,liveUsage:this.TYPE_LIVE_USAGE_REPORT},this._supportsWS="WebSocket"in window||"MozWebSocket"in window,this._folderId=isNaN(+b)?void 0:b,this._pageId=isNaN(+a)?void 0:a,this._folderName=isNaN(+b)?b:void 0,this._pageName=isNaN(+a)?a:void 0,this._pageId?this.init():(this.updatesOn=!1,this.getPageId(this._folderName,this._pageName).then(function(a){d._pageId=a.pageId,d._folderId=a.folderId,d.init()},function(a){d.onPageError(a)}))}return __extends(f,c),Object.defineProperty(f.prototype,"TYPE_REGULAR",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"TYPE_ALERT",{get:function(){return 5},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"TYPE_PDF",{get:function(){return 6},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"TYPE_PAGE_ACCESS_REPORT",{get:function(){return 1001},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"TYPE_DOMAIN_USAGE_REPORT",{get:function(){return 1002},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"TYPE_GLOBAL_USAGE_REPORT",{get:function(){return 1003},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"TYPE_PAGE_UPDATE_REPORT",{get:function(){return 1004},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"TYPE_LIVE_USAGE_REPORT",{get:function(){return 1007},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"EVENT_READY",{get:function(){return"ready"},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"EVENT_DECRYPTED",{get:function(){return"decrypted"},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"EVENT_NEW_CONTENT",{get:function(){return"new_content"},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"EVENT_NEW_META",{get:function(){return"new_meta";
},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"EVENT_ACCESS_UPDATED",{get:function(){return"access_updated"},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"EVENT_ERROR",{get:function(){return"error"},enumerable:!0,configurable:!0}),f.create=function(a,c,d,g){void 0===d&&(d=0);var h=b.defer();if(g){var i=new f(g.id,g.domain_id);i.on(i.EVENT_READY,function(){i.clone(a,c).then(h.resolve,h.reject).finally(function(){i.destroy()})})}else e.createPage({domainId:a,data:{name:c,special_page_type:d}}).then(function(b){var c=new f(b.data.id,a);c.on(c.EVENT_READY,function(){c.stop(),h.resolve(c)})},function(a){h.reject(a)});return h.promise},Object.defineProperty(f.prototype,"encryptionKeyPull",{set:function(a){this._encryptionKeyPull=a},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"encryptionKeyPush",{set:function(a){this._encryptionKeyPush=a},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"access",{get:function(){return this._access},enumerable:!0,configurable:!0}),f.prototype.start=function(){this.updatesOn||(this._provider.start(),this.updatesOn=!0)},f.prototype.stop=function(){this.updatesOn&&(this._provider.stop(),this.updatesOn=!1)},f.prototype.push=function(a){var c=this;void 0===a&&(a=!1);var d=b.defer(),e=function(a){c.Content.cleanDirty(),c.Content.update(c.Content.getFull()),c._data=angular.extend({},c._data,a.data),c._provider instanceof o&&(c._provider.seqNo=c._data.seq_no),c.emit(c.EVENT_NEW_CONTENT,c._data),d.resolve(a)};return this._data.encryption_type_to_use||this._data.encryption_type_used||!this.Content.canDoDelta||a?this.pushFull(this.Content.getFull()).then(e,d.reject):this.pushDelta(this.Content.getDelta()).then(e,d.reject),d.promise},f.prototype.saveMeta=function(c){var d=this,f=b.defer();return delete c.access_rights,0===c.encryption_type_to_use&&(c.encryption_key_to_use=""),e.savePageSettings({domainId:this._folderId,pageId:this._pageId,data:c}).then(function(a){d._data=angular.extend({},d._data,a.data),f.resolve(a)},function(b){f.reject(a.Utils.parseApiError(b,"Could not save page settings"))}),f.promise},f.prototype.setAsFoldersDefault=function(){var a=this,c=b.defer(),d={domainId:this._folderId,data:{default_page_id:this._pageId}};return e.setDomainDefault(d).then(function(b){a._access.is_users_default_page=!0,c.resolve(b)},c.reject),c.promise},f.prototype.del=function(){var a={domainId:this._folderId,pageId:this._pageId};return e.deletePage(a)},f.prototype.decrypt=function(b){if(b||(b=this._encryptionKeyPull),this._data.encryption_type_used&&!b.passphrase)return void(this.decrypted=!1);if(this._data.encryption_type_used){var c=h.decryptContent({name:b.name,passphrase:b.passphrase},this._data.encrypted_content);c?(this.decrypted=!0,this._data.content=c,this._encryptionKeyPull=b):(this.decrypted=!1,this.emit(this.EVENT_ERROR,new Error('Could not decrypt page with key "'+b.name+'" and passphrase "'+b.passphrase+'"')))}else this.decrypted=!0;this.decrypted&&(this.Content?this.Content.update(this._data.content):this.Content=new a.PageContent(this._data.content),this.emit(this.EVENT_DECRYPTED))},f.prototype.destroy=function(){this._provider&&this._provider.destroy(),d.cancel(this._accessInterval),this.removeEvent()},f.prototype.clone=function(a,c,d){var e=this;void 0===d&&(d={});var g=b.defer();return this.ready?(d.clone_ranges&&this._folderId!==a&&(d.clone_ranges=!1),f.create(a,c,this._data.special_page_type).then(function(a){a.Content=e.Content,b.all([a.push(!0)]).then(function(b){g.resolve(a)},g.reject)},function(a){g.reject(a)}),g.promise):(g.reject("Page is not ready"),g.promise)},f.prototype.init=function(){var a=this;this.Ranges=new n(this._folderId,this._pageId),!this._supportsWS||"undefined"==typeof io,this._provider=this._supportsWS&&"undefined"!=typeof io&&"polling"!==i.transport?new p(this._pageId,this._folderId):new o(this._pageId,this._folderId),this.getPageAccess(),this._accessInterval=d(function(){a.getPageAccess()},3e4),this.registerListeners()},f.prototype.getPageId=function(a,c){var d=b.defer();return e.getPageByName({domainId:a,pageId:c}).then(function(a){d.resolve({pageId:a.data.id,folderId:a.data.domain_id})},function(a){d.reject(a)}),d.promise},f.prototype.getPageAccess=function(){var a=this,c=b.defer();return e.getPageAccess({domainId:this._folderId,pageId:this._pageId}).then(function(b){a._access=b.data,a._accessLoaded=!0,a.checkReady(),a.emit(a.EVENT_ACCESS_UPDATED),c.resolve()},function(b){a.onPageError(b),c.reject()}),c.promise},f.prototype.registerListeners=function(){var a=this;this._provider.on("content_update",function(b){b.special_page_type=a.updatePageType(b.special_page_type),a._data=angular.extend({},a._data,b),a.decrypt(),a._contentLoaded=!0,a.checkReady(),a.emit(a.EVENT_NEW_CONTENT,a._data)}),this._provider.on("meta_update",function(b){b.special_page_type=a.updatePageType(b.special_page_type),delete b.content,delete b.encrypted_content,a._data=angular.extend({},a._data,b),a.Ranges.parse(b.access_rights||"[]"),a._metaLoaded=!0,a.checkReady(),a.emit(a.EVENT_NEW_META,b)}),this._provider.on("error",this.onPageError)},f.prototype.pushFull=function(a){var c=this,d=b.defer();if(this._data.encryption_type_to_use){if(!this._encryptionKeyPush||this._data.encryption_key_to_use!==this._encryptionKeyPush.name)return d.reject("None or wrong encryption key"),d.promise;var f=this.encrypt(this._encryptionKeyPush,a);if(!f)return d.reject("Encryption failed"),d.promise;this._data.encrypted_content=f,this._data.encryption_type_used=1,this._data.encryption_key_used=this._encryptionKeyPush.name,this._encryptionKeyPull=angular.copy(this._encryptionKeyPush)}else this._data.encryption_key_used="",this._data.encryption_type_used=0,this._data.content=a;var g={content:this._data.encryption_type_used?"":this._data.content,encrypted_content:this._data.encrypted_content,encryption_type_used:this._data.encryption_type_used,encryption_key_used:this._data.encryption_key_used},h={domainId:this._folderId,pageId:this._pageId,data:g};return e.savePageContent(h).then(function(a){c._data.seq_no=a.data.seq_no,d.resolve(a)},d.reject),d.promise},f.prototype.pushDelta=function(a){var c=b.defer(),d={domainId:this._folderId,pageId:this._pageId,data:a};return e.savePageContentDelta(d).then(c.resolve,c.reject),c.promise},f.prototype.checkReady=function(){this._contentLoaded&&this._metaLoaded&&this._accessLoaded&&!this.ready&&(this.ready=!0,this.emit(this.EVENT_READY))},f.prototype.updatePageType=function(a){return(a>0&&a<5||7===a)&&(a+=1e3),a},f.prototype.encrypt=function(a,b){return h.encryptContent(a,b)},f}(EventEmitter),l=function(){function a(a,b,c,d,e,f){void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=0),this.name=a,this.rowStart=b,this.rowEnd=c,this.colStart=d,this.colEnd=e,this._permissions={ro:[],no:[]},f&&(this._permissions=f)}return a.prototype.setPermission=function(a,b){this._permissions.ro.indexOf(a)>=0&&this._permissions.ro.splice(this._permissions.ro.indexOf(a),1),this._permissions.no.indexOf(a)>=0&&this._permissions.no.splice(this._permissions.no.indexOf(a),1),b&&this._permissions[b].push(a)},a.prototype.getPermission=function(a){var b="";return this._permissions.ro.indexOf(a)>=0?b="ro":this._permissions.no.indexOf(a)>=0&&(b="no"),b},a.prototype.toObject=function(){return{name:this.name,start:this.rowStart+":"+this.colStart,end:this.rowEnd+":"+this.colEnd,rights:this._permissions,freeze:!1}},a}();a.PermissionRange=l;var m=function(){function a(a,b,c){void 0===b&&(b="rows"),void 0===c&&(c=1),this.name=a,this.subject=b,this.count=c}return Object.defineProperty(a,"SUBJECT_ROWS",{get:function(){return"rows"},enumerable:!0,configurable:!0}),Object.defineProperty(a,"SUBJECT_COLUMNS",{get:function(){return"cols"},enumerable:!0,configurable:!0}),a.prototype.toObject=function(){var b={name:this.name,start:"0:0",end:"",rights:{ro:[],no:[]},freeze:!0};return this.subject===a.SUBJECT_ROWS?b.end=this.count-1+":-1":b.end="-1:"+(this.count-1),b},a}();a.FreezingRange=m;var n=function(){function a(a,b,c){this._ranges=[],this._folderId=a,this._pageId=b,c&&this.parse(c)}return Object.defineProperty(a.prototype,"TYPE_PERMISSION_RANGE",{get:function(){return"permissions"},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"TYPE_FREEZING_RANGE",{get:function(){return"freezing"},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ranges",{get:function(){return this._ranges},enumerable:!0,configurable:!0}),a.prototype.setRanges=function(a){return this._ranges=a,this},a.prototype.addRange=function(a){if(a instanceof m)for(var b=0;b<this._ranges.length;b++)if(this._ranges[b].subject===a.subject){this.removeRange(this._ranges[b].name);break}for(var c=!1,d=a.name,e=1;!c;){c=!0;for(var b=0;b<this._ranges.length;b++)this._ranges[b].name===d&&(c=!1,d=a.name+"_"+e,e++)}return a.name=d,this._ranges.push(a),this},a.prototype.removeRange=function(a){for(var b=-1,c=0;c<this._ranges.length;c++)if(this._ranges[c].name===a){b=c;break}return b>=0&&this._ranges.splice(b,1),this},a.prototype.save=function(){for(var a=[],b=0;b<this._ranges.length;b++)a.push(this._ranges[b].toObject());var c={domainId:this._folderId,pageId:this._pageId,data:{access_rights:JSON.stringify(a)}};return e.savePageSettings(c)},a.prototype.parse=function(a){var b=JSON.parse(a);this._ranges=[];for(var c=0;c<b.length;c++){var d=parseInt(b[c].start.split(":")[0],10),e=parseInt(b[c].end.split(":")[0],10),f=parseInt(b[c].start.split(":")[1],10),g=parseInt(b[c].end.split(":")[1],10);if(b[c].freeze){var h=g>=0?"cols":"rows",i=g>=0?g+1:e+1;this._ranges.push(new m(b[c].name,h,i))}else this._ranges.push(new l(b[c].name,d,e,f,g,b[c].rights))}return this._ranges},a}(),o=function(a){function d(b,c){a.call(this),this._pageId=b,this._folderId=c,this._stopped=!1,this._requestOngoing=!1,this._timeout=1e3,this._seqNo=0,this.start()}return __extends(d,a),Object.defineProperty(d.prototype,"seqNo",{set:function(a){this._seqNo=a},enumerable:!0,configurable:!0}),d.prototype.start=function(){this._stopped=!1,this.startPolling()},d.prototype.stop=function(){this._stopped=!0,c.cancel(this._timer)},d.prototype.destroy=function(){this.stop(),this.removeEvent()},d.prototype.startPolling=function(){var a=this;this.load(),this._timer=c(function(){a.startPolling()},this._timeout)},d.prototype.load=function(a){var c=this;void 0===a&&(a=!1);var d=b.defer();return this._requestOngoing||this._stopped?(d.reject({}),d.promise):(this._requestOngoing=!0,e.getPage({domainId:this._folderId,pageId:this._pageId,seq_no:a?void 0:this._seqNo}).then(function(a){200===a.httpCode||204===a.httpCode?(200===a.httpCode?(c._seqNo=a.data.seq_no,c._timeout=1e3*a.data.pull_interval,c.emit("content_update",c.tempGetContentOb(a.data)),c.emit("meta_update",c.tempGetSettingsOb(a.data))):c.emit("empty_update"),d.resolve(a.data)):(c.emit("error",a.data),d.reject({}))},function(a){c.emit("error",a),d.reject(a)}).finally(function(){c._requestOngoing=!1}),d.promise)},d.prototype.tempGetContentOb=function(a){return{id:a.id,domain_id:a.domain_id,seq_no:a.seq_no,content_modified_timestamp:a.content_modified_timestamp,content:a.content,content_modified_by:a.content_modified_by,push_interval:a.push_interval,pull_interval:a.pull_interval,is_public:a.is_public,description:a.description,encrypted_content:a.encrypted_content,encryption_key_used:a.encryption_key_used,encryption_type_used:a.encryption_type_used,special_page_type:a.special_page_type}},d.prototype.tempGetSettingsOb=function(a){return JSON.parse(JSON.stringify(a))},d}(EventEmitter),p=function(a){function b(b,d){var e=this;a.call(this),this._pageId=b,this._folderId=d,this._stopped=!1,this.onConnect=function(){},this.onDisconnect=function(){},this.onPageContent=function(a){c(function(){e.emit("content_update",a)})},this.onPageSettings=function(a){c(function(){e.emit("meta_update",a)})},this.onPageError=function(a){c(function(){401===a.code?f.emit(f.EVENT_401):e.emit("error",a)})},this.onOAuthError=function(a){},this.onAuthRefresh=function(){e._pageId;e.start()},this.supportsWebSockets=function(){return"WebSocket"in window||"MozWebSocket"in window},this.start(),f.on(f.EVENT_LOGIN_REFRESHED,this.onAuthRefresh)}return __extends(b,a),Object.defineProperty(b,"SOCKET_EVENT_PAGE_ERROR",{get:function(){return"page_error"},enumerable:!0,configurable:!0}),Object.defineProperty(b,"SOCKET_EVENT_PAGE_CONTENT",{get:function(){return"page_content"},enumerable:!0,configurable:!0}),Object.defineProperty(b,"SOCKET_EVENT_PAGE_PUSH",{get:function(){return"page_push"},enumerable:!0,configurable:!0}),Object.defineProperty(b,"SOCKET_EVENT_PAGE_SETTINGS",{get:function(){return"page_settings"},enumerable:!0,configurable:!0}),Object.defineProperty(b,"SOCKET_EVENT_PAGE_DATA",{get:function(){return"page_data"},enumerable:!0,configurable:!0}),Object.defineProperty(b,"SOCKET_EVENT_PAGE_USER_JOINED",{get:function(){return"page_user_joined"},enumerable:!0,configurable:!0}),Object.defineProperty(b,"SOCKET_EVENT_PAGE_USER_LEFT",{get:function(){return"page_user_left"},enumerable:!0,configurable:!0}),b.prototype.start=function(){this._socket&&this._socket.connected?this._socket.on(b.SOCKET_EVENT_PAGE_CONTENT,this.onPageContent):this.init()},b.prototype.stop=function(){this._socket.off(b.SOCKET_EVENT_PAGE_CONTENT,this.onPageContent),this._stopped=!0},b.prototype.destroy=function(){this._socket.removeAllListeners(),this._socket.disconnect(),this.stop(),f.off(f.EVENT_LOGIN_REFRESHED,this.onAuthRefresh),this.removeEvent()},b.prototype.init=function(){this._socket=this.connect(),this._socket.on("connect",this.onConnect),this._socket.on(b.SOCKET_EVENT_PAGE_CONTENT,this.onPageContent),this._socket.on(b.SOCKET_EVENT_PAGE_SETTINGS,this.onPageSettings),this._socket.on(b.SOCKET_EVENT_PAGE_ERROR,this.onPageError),this._socket.on("oauth_error",this.onOAuthError),this._socket.on("disconnect",this.onDisconnect),this._stopped=!1},b.prototype.connect=function(){var a=["access_token="+g.persistent.get("access_token")];return a=a.filter(function(a){return a.length>0}),io.connect(i.ws_url+"/page/"+this._pageId,{query:a.join("&"),transports:this.supportsWebSockets()?["websocket"]:["polling"],forceNew:!0})},b}(EventEmitter)}(ipushpull||(ipushpull={}));var ipushpull;!function(a){"use strict";var b=function(){function a(){this.prefix="ipp"}return a.prototype.create=function(a,b){localStorage.setItem(this.makeKey(a),b)},a.prototype.save=function(a,b){return this.create(a,b)},a.prototype.get=function(a,b){void 0===b&&(b=null);var c=localStorage.getItem(this.makeKey(a));return c?this.isValidJSON(c)?JSON.parse(c):c:b},a.prototype.remove=function(a){localStorage.removeItem(this.makeKey(a))},a.prototype.makeKey=function(a){return this.prefix&&0!==a.indexOf(this.prefix)&&(a=this.prefix+"_"+a),this.suffix&&(a=a+"_"+this.suffix),a},a.prototype.isValidJSON=function(a){try{JSON.parse(a);return!0}catch(a){return!1}},a}(),c=function(){function a(){this.prefix="ipp",this._domain=document.domain.replace(/(www)|(test)|(stable)|(beta)/,"")}return a.prototype.create=function(a,b,c){var d="";if(c){var e=new Date;e.setTime(e.getTime()+24*c*60*60*1e3),d="; expires="+e.toUTCString()}document.cookie=this.makeKey(a)+"="+b+d+"; path=/; domain="+this._domain+(this.isSecure()?";secure;":"")},a.prototype.save=function(a,b,c){this.create(a,b,c)},a.prototype.get=function(a,b){a=this.makeKey(a);for(var c=a+"=",d=document.cookie.split(";"),e=0;e<d.length;e++){for(var f=d[e];" "===f.charAt(0);)f=f.substring(1,f.length);if(0===f.indexOf(c)){var g=f.substring(c.length,f.length);return this.isValidJSON(g)?JSON.parse(g):g}}},a.prototype.remove=function(a){this.create(this.makeKey(a),"",-1)},a.prototype.isSecure=function(){return"https:"===window.location.protocol},a.prototype.makeKey=function(a){return this.prefix&&0!==a.indexOf(this.prefix)&&(a=this.prefix+"_"+a),this.suffix&&(a=a+"_"+this.suffix),a},a.prototype.isValidJSON=function(a){try{JSON.parse(a);return!0}catch(a){return!1}},a}(),d=function(){function a(a){var d=new b;d.suffix="GUEST";var e=new b,f=navigator.cookieEnabled?new c:new b;return a.storage_prefix&&(d.prefix=a.storage_prefix,e.prefix=a.storage_prefix,f.prefix=a.storage_prefix),{user:d,global:e,persistent:f}}return a.$inject=["ippConfig"],a}();a.module.factory("ippStorageService",d)}(ipushpull||(ipushpull={}));var ipushpull;!function(a){"use strict";var b=function(){function a(){}return a.prototype.parseApiError=function(a,b){var c=b;if(a.data){var d=Object.keys(a.data);c=d.length?angular.isArray(a.data[d[0]])?a.data[d[0]][0]:"string"==typeof a.data[d[0]]?a.data[d[0]]:b:b}else c=b;return c},a.prototype.clonePageContent=function(a){for(var b=[],c=0;c<a.length;c++){b.push([]);for(var d=0;d<a[c].length;d++){var e={};for(var f in a[c][d])a[c][d].hasOwnProperty(f)&&(e[f]=a[c][d][f]);b[c].push(e)}}return b},a}();a.Utils=new b}(ipushpull||(ipushpull={}));